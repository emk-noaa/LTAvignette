<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 11 Subgroup-based analysis | User’s guide for LTabundR</title>
  <meta name="description" content="vignette" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content=" 11 Subgroup-based analysis | User’s guide for LTabundR" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="vignette" />
  <meta name="github-repo" content="emk-noaa/emk-noaa.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 11 Subgroup-based analysis | User’s guide for LTabundR" />
  
  <meta name="twitter:description" content="vignette" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="trend-analysis.html"/>
<link rel="next" href="tables.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">WinCruz analysis</a></li>

<li class="divider"></li>
<li><a href="index.html#overview">Overview<span></span></a></li>
<li class="part"><span><b>I Data processing<span></span></b></span></li>
<li class="chapter" data-level="1" data-path="install.html"><a href="install.html"><i class="fa fa-check"></i><b>1</b> Install <code>LTabundR</code><span></span></a><ul>
<li><a href="install.html#option-1-install-from-github">Option 1: Install from GitHub<span></span></a></li>
<li><a href="install.html#option-2-install-locally">Option 2: Install locally<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="settings.html"><a href="settings.html"><i class="fa fa-check"></i><b>2</b> Settings<span></span></a><ul>
<li><a href="settings.html#survey-strata">Survey strata<span></span></a></li>
<li><a href="settings.html#survey-wide-settings">Survey-wide settings<span></span></a></li>
<li><a href="settings.html#cohort-specific-settings">Cohort-specific settings<span></span></a></li>
<li><a href="settings.html#example-code">Example code<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="processing.html"><a href="processing.html"><i class="fa fa-check"></i><b>3</b> Data processing<span></span></a><ul>
<li><a href="processing.html#behind-the-scenes">Behind the scenes<span></span></a></li>
<li><a href="processing.html#review">Review<span></span></a></li>
</ul></li>
<li class="part"><span><b>II Data exploration<span></span></b></span></li>
<li class="chapter" data-level="4" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>4</b> Maps<span></span></a><ul>
<li><a href="maps.html#publishable-maps">Publishable maps<span></span></a></li>
<li><a href="maps.html#interactive-maps">Interactive maps<span></span></a></li>
<li><a href="maps.html#interactive-dashboard">Interactive dashboard<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="filter.html"><a href="filter.html"><i class="fa fa-check"></i><b>5</b> Filter &amp; combine surveys<span></span></a><ul>
<li><a href="filter.html#filter-1">Filter<span></span></a></li>
<li><a href="filter.html#combine">Combine<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="summarize.html"><a href="summarize.html"><i class="fa fa-check"></i><b>6</b> Summarize survey<span></span></a><ul>
<li><a href="summarize.html#summarize-effort">Summarize effort<span></span></a></li>
<li><a href="summarize.html#summarize-by-beaufort">Summarize by Beaufort<span></span></a></li>
<li><a href="summarize.html#summarize-sightings">Summarize sightings<span></span></a></li>
<li><a href="summarize.html#summarize-certain-species">Summarize certain species<span></span></a></li>
<li><a href="summarize.html#cruz_explorer"><code>cruz_explorer()</code><span></span></a></li>
</ul></li>
<li class="part"><span><b>III Data analysis<span></span></b></span></li>
<li class="chapter" data-level="7" data-path="g0.html"><a href="g0.html"><i class="fa fa-check"></i><b>7</b> Estimating g(0)<span></span></a><ul>
<li><a href="g0.html#relative-g0">Relative <code>g(0)</code><span></span></a></li>
<li><a href="g0.html#weighted-average-g0">Weighted average <code>g(0)</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="lta.html"><a href="lta.html"><i class="fa fa-check"></i><b>8</b> Line-transect analysis<span></span></a><ul>
<li><a href="lta.html#key-inputs">Key inputs<span></span></a></li>
<li><a href="lta.html#variance-estimation">Variance estimation<span></span></a></li>
<li><a href="lta.html#other-inputs">Other inputs<span></span></a></li>
<li><a href="lta.html#output">Output<span></span></a></li>
<li><a href="lta.html#unusual-estimate-scenarios">Unusual estimate scenarios<span></span></a></li>
<li><a href="lta.html#behind-the-scenes-1">Behind the scenes<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="destratify.html"><a href="destratify.html"><i class="fa fa-check"></i><b>9</b> Stratified analysis<span></span></a></li>
<li class="chapter" data-level="10" data-path="trend-analysis.html"><a href="trend-analysis.html"><i class="fa fa-check"></i><b>10</b> Trend analysis<span></span></a></li>
<li class="chapter" data-level="11" data-path="subgroup-based-analysis.html"><a href="subgroup-based-analysis.html"><i class="fa fa-check"></i><b>11</b> Subgroup-based analysis<span></span></a><ul>
<li><a href="subgroup-based-analysis.html#inputs-1">Inputs<span></span></a></li>
<li><a href="subgroup-based-analysis.html#outputs-1">Outputs<span></span></a></li>
<li><a href="subgroup-based-analysis.html#behind-the-scenes-2">Behind the scenes<span></span></a></li>
</ul></li>
<li class="part"><span><b>IV Results<span></span></b></span></li>
<li class="chapter" data-level="12" data-path="tables.html"><a href="tables.html"><i class="fa fa-check"></i><b>12</b> Tables<span></span></a><ul>
<li><a href="tables.html#summary-tables">Summary tables<span></span></a></li>
<li><a href="tables.html#appendix-tables">Appendix tables<span></span></a></li>
<li><a href="tables.html#abundance-plots">Abundance plots<span></span></a></li>
<li><a href="tables.html#detection-function-plots">Detection function plots<span></span></a></li>
</ul></li>
<li class="part"><span><b>V Case studies<span></span></b></span></li>
<li class="chapter" data-level="13" data-path="whiceas.html"><a href="whiceas.html"><i class="fa fa-check"></i><b>13</b> WHICEAS<span></span></a><ul>
<li><a href="whiceas.html#data-processing">Data processing<span></span></a></li>
<li><a href="whiceas.html#data-exploration">Data exploration<span></span></a></li>
<li><a href="whiceas.html#rg0-1">Rg0<span></span></a></li>
<li><a href="whiceas.html#density-abundance">Density &amp; abundance<span></span></a></li>
<li><a href="whiceas.html#results">Results<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="case_cnp.html"><a href="case_cnp.html"><i class="fa fa-check"></i><b>14</b> Central North Pacific<span></span></a><ul>
<li><a href="case_cnp.html#data-processing-1">Data processing<span></span></a></li>
<li><a href="case_cnp.html#data-exploration-1">Data exploration<span></span></a></li>
<li><a href="case_cnp.html#rg0-2">Rg0<span></span></a></li>
<li><a href="case_cnp.html#density-abundance-1">Density &amp; abundance<span></span></a></li>
<li><a href="case_cnp.html#stratified-results">Stratified results<span></span></a></li>
<li><a href="case_cnp.html#de-stratified-results">De-stratified results<span></span></a></li>
<li><a href="case_cnp.html#plots-1">Plots<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="california-current-system.html"><a href="california-current-system.html"><i class="fa fa-check"></i><b>15</b> California Current System<span></span></a></li>
<li class="part"><span><b>VI Appendix<span></span></b></span><ul>
<li><a href="california-current-system.html#central-north-pacific">Central North Pacific<span></span></a></li>
<li><a href="california-current-system.html#california-current">California Current<span></span></a></li>
<li><a href="california-current-system.html#etp">ETP<span></span></a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="segmentizing.html"><a href="segmentizing.html"><i class="fa fa-check"></i><b>16</b> Segmentizing<span></span></a><ul>
<li><a href="segmentizing.html#approach">Approach<span></span></a></li>
<li><a href="segmentizing.html#defaults-2">Defaults<span></span></a></li>
<li><a href="segmentizing.html#day-vs-equal-length">Day vs Equal Length<span></span></a></li>
<li><a href="segmentizing.html#contiguous-vs.-non-contiguous-effort">Contiguous vs. non-contiguous effort<span></span></a></li>
<li><a href="segmentizing.html#segment-remainder-handling">Segment remainder handling<span></span></a></li>
<li><a href="segmentizing.html#typical-settings">Typical settings<span></span></a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="abund9_compare.html"><a href="abund9_compare.html"><i class="fa fa-check"></i><b>17</b> <code>LTabundR</code> vs. <code>ABUND9</code><span></span></a><ul>
<li><a href="abund9_compare.html#differences-in-total-effort">Differences in total effort<span></span></a></li>
<li><a href="abund9_compare.html#differences-in-on-effort-distance">Differences in on-effort distance<span></span></a></li>
<li><a href="abund9_compare.html#differences-in-total-sightings">Differences in total sightings<span></span></a></li>
<li><a href="abund9_compare.html#differences-in-on-effort-sightings">Differences in on-effort sightings<span></span></a></li>
<li><a href="abund9_compare.html#differences-in-school-size-estimation">Differences in school size estimation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="spp_codes.html"><a href="spp_codes.html"><i class="fa fa-check"></i><b>18</b> NOAA/NMFS species codes<span></span></a><ul>
<li><a href="spp_codes.html#table">Table<span></span></a></li>
<li><a href="spp_codes.html#species_translator"><code>species_translator()</code><span></span></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/emk-noaa/emk-noaa.github.io" target="blank">Eric & Amanda</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">User’s guide for <code>LTabundR</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="subgroup-based-analysis" class="section level1 hasAnchor">
<h1><span class="header-section-number"> 11</span> Subgroup-based analysis<a href="subgroup-based-analysis.html#subgroup-based-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>False killer whales (<em>Pseudorca crassidens</em>) are rare and occur in dispersed subgroups, which complicates conventional distance sampling approaches to line-transect analysis. To better estimate their abundance, in 2010 the Pacific Islands Fisheries Science Center (PIFSC) initiated a sub-group protocol referred to as the “PC Protocol”, a reference to the species’ scientific name.</p>
<p>To conduct line-transect analysis with this sub-group-based protocol, a method was developed in 2014 - 2017
To handle this, a separate, <em>subgroup-based</em> analytical approach was developed in 2014 - 2017, then updated in 2020 (<a href="https://www.fisheries.noaa.gov/inport/item/59592">Bradford et al. 2020</a>).</p>
<p>An additional complication is that false killer whales in Hawaiian waters belong to two discrete populations – the Northwest Hawaiian Islands (NWHI) population and a pelagic population – whose ranges partially overlap, which means that population assignment cannot always be based simply on the geographic location of sightings. When geographic inference of population is not possible, biopsy-sampled genetics, photo-identification, and acoustics are used to assign each sighting to a population <em>post-hoc</em>.</p>
<p>To accommodate these special circumstances with an appropriate balance of flexibility and efficiency, <code>LTabundR</code> includes a function named <code>lta_subgroup()</code>, whose use will look something like this:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="subgroup-based-analysis.html#cb1-1"></a><span class="kw">lta_subgroup</span>(df_sits,</span>
<span id="cb1-2"><a href="subgroup-based-analysis.html#cb1-2"></a>             truncation_distance,</span>
<span id="cb1-3"><a href="subgroup-based-analysis.html#cb1-3"></a>             ss,</span>
<span id="cb1-4"><a href="subgroup-based-analysis.html#cb1-4"></a>             cruz10,</span>
<span id="cb1-5"><a href="subgroup-based-analysis.html#cb1-5"></a>             g0_spp,</span>
<span id="cb1-6"><a href="subgroup-based-analysis.html#cb1-6"></a>             g0_truncation,</span>
<span id="cb1-7"><a href="subgroup-based-analysis.html#cb1-7"></a>             g0_pool_bft,</span>
<span id="cb1-8"><a href="subgroup-based-analysis.html#cb1-8"></a>             <span class="dt">g0_jackknife_fraction =</span> <span class="fl">0.1</span>,</span>
<span id="cb1-9"><a href="subgroup-based-analysis.html#cb1-9"></a>             density_segments,</span>
<span id="cb1-10"><a href="subgroup-based-analysis.html#cb1-10"></a>             density_das,</span>
<span id="cb1-11"><a href="subgroup-based-analysis.html#cb1-11"></a>             density_sightings,</span>
<span id="cb1-12"><a href="subgroup-based-analysis.html#cb1-12"></a>             abundance_area,</span>
<span id="cb1-13"><a href="subgroup-based-analysis.html#cb1-13"></a>             <span class="dt">iterations =</span> <span class="dv">1000</span>,</span>
<span id="cb1-14"><a href="subgroup-based-analysis.html#cb1-14"></a>             <span class="dt">output_dir =</span> <span class="st">&#39;../test_code/subgroup/&#39;</span>,</span>
<span id="cb1-15"><a href="subgroup-based-analysis.html#cb1-15"></a>             <span class="dt">toplot =</span> <span class="ot">TRUE</span>,</span>
<span id="cb1-16"><a href="subgroup-based-analysis.html#cb1-16"></a>             <span class="dt">verbose =</span> <span class="ot">TRUE</span>,</span>
<span id="cb1-17"><a href="subgroup-based-analysis.html#cb1-17"></a>             <span class="dt">density_bootstraps =</span> <span class="dv">10000</span>)</span></code></pre></div>
<p>We will step through each of these inputs below, using a case study in which we estimate false killer whale abundance in the Hawaiian EEZ for 2017.</p>
<div id="inputs-1" class="section level2 unnumbered hasAnchor">
<h2>Inputs<a href="subgroup-based-analysis.html#inputs-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="df_sits" class="section level3 unnumbered hasAnchor">
<h3><code>df_sits</code><a href="subgroup-based-analysis.html#df_sits" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is a <code>data.frame</code> of sightings you want to use to fit the detection function model. For false killer whales in Bradford et al. (2020), this is a combination of systematic sightings prior to 2010 and Phase 1 sightings from 2010 onwards (using the PC protocol). No filtering will be applied to these sightings within this function, so make sure you provide the data pre-filtered. Bradford et al. (2020) used a single detection function for all populations of false killer whale.</p>
<p><code>LTabundR</code> has a built-in dataset for processed Central North Pacific surveys, 1986-2020, using 150-km segments. We will use that here:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="subgroup-based-analysis.html#cb2-1"></a><span class="kw">data</span>(<span class="st">&quot;cnp_150km_1986_2020&quot;</span>)</span>
<span id="cb2-2"><a href="subgroup-based-analysis.html#cb2-2"></a>cruz &lt;-<span class="st"> </span>cnp_150km_<span class="dv">1986</span>_<span class="dv">2020</span></span></code></pre></div>
<p>The code used to generate this dataset can be seen by pulling up the help documentation: <code>?noaa_10km_1986_2020</code>.</p>
<p>As mentioned above, for 1986 - 2010, all detections are assumed to be ‘Phase 1’ sightings, and therefore usable in detection function estimation. Here we draw those sightings from the above <code>cruz</code> object, filtering as needed (the species code for false killer whales is <code>"033"</code>), and to simplify we will select only a few key columns.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="subgroup-based-analysis.html#cb3-1"></a>sits1  &lt;-</span>
<span id="cb3-2"><a href="subgroup-based-analysis.html#cb3-2"></a><span class="st">  </span>cruz<span class="op">$</span>cohorts<span class="op">$</span>all<span class="op">$</span>sightings <span class="op">%&gt;%</span></span>
<span id="cb3-3"><a href="subgroup-based-analysis.html#cb3-3"></a><span class="st">  </span><span class="kw">filter</span>(OnEffort <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb3-4"><a href="subgroup-based-analysis.html#cb3-4"></a>         year <span class="op">&lt;</span><span class="st"> </span><span class="dv">2011</span>,</span>
<span id="cb3-5"><a href="subgroup-based-analysis.html#cb3-5"></a>         Lat <span class="op">&gt;=</span><span class="st"> </span><span class="dv">5</span>, Lat <span class="op">&lt;=</span><span class="st"> </span><span class="dv">40</span>, Lon <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-185</span>, Lon <span class="op">&lt;=</span><span class="st"> </span><span class="dv">-120</span>,</span>
<span id="cb3-6"><a href="subgroup-based-analysis.html#cb3-6"></a>         species <span class="op">==</span><span class="st"> &#39;033&#39;</span>,</span>
<span id="cb3-7"><a href="subgroup-based-analysis.html#cb3-7"></a>         mixed <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>) <span class="op">%&gt;%</span></span>
<span id="cb3-8"><a href="subgroup-based-analysis.html#cb3-8"></a><span class="st">  </span><span class="kw">select</span>(DateTime, Lat, Lon, Cruise, PerpDistKm)</span>
<span id="cb3-9"><a href="subgroup-based-analysis.html#cb3-9"></a></span>
<span id="cb3-10"><a href="subgroup-based-analysis.html#cb3-10"></a>sits1 <span class="op">%&gt;%</span><span class="st"> </span>nrow</span>
<span id="cb3-11"><a href="subgroup-based-analysis.html#cb3-11"></a><span class="co">## [1] 33</span></span>
<span id="cb3-12"><a href="subgroup-based-analysis.html#cb3-12"></a></span>
<span id="cb3-13"><a href="subgroup-based-analysis.html#cb3-13"></a>sits1 <span class="op">%&gt;%</span><span class="st"> </span>head</span>
<span id="cb3-14"><a href="subgroup-based-analysis.html#cb3-14"></a><span class="co">##              DateTime       Lat       Lon Cruise PerpDistKm</span></span>
<span id="cb3-15"><a href="subgroup-based-analysis.html#cb3-15"></a><span class="co">## 1 1986-11-13 09:43:00 10.466667 -139.2833    990 1.17493742</span></span>
<span id="cb3-16"><a href="subgroup-based-analysis.html#cb3-16"></a><span class="co">## 2 1987-08-19 15:30:00 12.050000 -133.3000   1080 2.24543067</span></span>
<span id="cb3-17"><a href="subgroup-based-analysis.html#cb3-17"></a><span class="co">## 3 1987-12-01 09:23:00  8.266667 -122.5500   1080 0.42589077</span></span>
<span id="cb3-18"><a href="subgroup-based-analysis.html#cb3-18"></a><span class="co">## 4 1989-08-22 06:45:00 11.800000 -141.7333   1268 0.40838431</span></span>
<span id="cb3-19"><a href="subgroup-based-analysis.html#cb3-19"></a><span class="co">## 5 1989-08-22 16:39:00 12.716667 -143.1000   1268 0.68815211</span></span>
<span id="cb3-20"><a href="subgroup-based-analysis.html#cb3-20"></a><span class="co">## 6 1989-09-10 17:18:00  7.350000 -129.5333   1268 0.07751339</span></span></code></pre></div>
<p>For 2011 onwards, we will use Phase 1 subgroup detections from the PC protocol, making sure that the column holding detection distances is named <code>PerpDistKm</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="subgroup-based-analysis.html#cb4-1"></a>sits2  &lt;-</span>
<span id="cb4-2"><a href="subgroup-based-analysis.html#cb4-2"></a><span class="st">  </span>cruz<span class="op">$</span>cohorts<span class="op">$</span>all<span class="op">$</span>subgroups<span class="op">$</span>subgroups <span class="op">%&gt;%</span></span>
<span id="cb4-3"><a href="subgroup-based-analysis.html#cb4-3"></a><span class="st">  </span><span class="kw">filter</span>(OnEffort <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb4-4"><a href="subgroup-based-analysis.html#cb4-4"></a>         lubridate<span class="op">::</span><span class="kw">year</span>(DateTime) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2011</span>,</span>
<span id="cb4-5"><a href="subgroup-based-analysis.html#cb4-5"></a>         Lat <span class="op">&gt;=</span><span class="st"> </span><span class="dv">5</span>, Lat <span class="op">&lt;=</span><span class="st"> </span><span class="dv">40</span>, Lon <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-185</span>, Lon <span class="op">&lt;=</span><span class="st"> </span><span class="dv">-120</span>,</span>
<span id="cb4-6"><a href="subgroup-based-analysis.html#cb4-6"></a>         Species <span class="op">==</span><span class="st"> &#39;033&#39;</span>,</span>
<span id="cb4-7"><a href="subgroup-based-analysis.html#cb4-7"></a>         Phase <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span></span>
<span id="cb4-8"><a href="subgroup-based-analysis.html#cb4-8"></a><span class="st">  </span><span class="kw">select</span>(DateTime, Lat, Lon, Cruise, <span class="dt">PerpDistKm =</span> PerpDist)</span>
<span id="cb4-9"><a href="subgroup-based-analysis.html#cb4-9"></a></span>
<span id="cb4-10"><a href="subgroup-based-analysis.html#cb4-10"></a>sits2 <span class="op">%&gt;%</span><span class="st"> </span>nrow</span>
<span id="cb4-11"><a href="subgroup-based-analysis.html#cb4-11"></a><span class="co">## [1] 53</span></span>
<span id="cb4-12"><a href="subgroup-based-analysis.html#cb4-12"></a></span>
<span id="cb4-13"><a href="subgroup-based-analysis.html#cb4-13"></a>sits1 <span class="op">%&gt;%</span><span class="st"> </span>head</span>
<span id="cb4-14"><a href="subgroup-based-analysis.html#cb4-14"></a><span class="co">##              DateTime       Lat       Lon Cruise PerpDistKm</span></span>
<span id="cb4-15"><a href="subgroup-based-analysis.html#cb4-15"></a><span class="co">## 1 1986-11-13 09:43:00 10.466667 -139.2833    990 1.17493742</span></span>
<span id="cb4-16"><a href="subgroup-based-analysis.html#cb4-16"></a><span class="co">## 2 1987-08-19 15:30:00 12.050000 -133.3000   1080 2.24543067</span></span>
<span id="cb4-17"><a href="subgroup-based-analysis.html#cb4-17"></a><span class="co">## 3 1987-12-01 09:23:00  8.266667 -122.5500   1080 0.42589077</span></span>
<span id="cb4-18"><a href="subgroup-based-analysis.html#cb4-18"></a><span class="co">## 4 1989-08-22 06:45:00 11.800000 -141.7333   1268 0.40838431</span></span>
<span id="cb4-19"><a href="subgroup-based-analysis.html#cb4-19"></a><span class="co">## 5 1989-08-22 16:39:00 12.716667 -143.1000   1268 0.68815211</span></span>
<span id="cb4-20"><a href="subgroup-based-analysis.html#cb4-20"></a><span class="co">## 6 1989-09-10 17:18:00  7.350000 -129.5333   1268 0.07751339</span></span></code></pre></div>
<p>To create <code>df_sits</code> for detection function fitting, we combine these datasets together:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="subgroup-based-analysis.html#cb5-1"></a>df_sits &lt;-<span class="st"> </span><span class="kw">rbind</span>(sits1, sits2)</span>
<span id="cb5-2"><a href="subgroup-based-analysis.html#cb5-2"></a></span>
<span id="cb5-3"><a href="subgroup-based-analysis.html#cb5-3"></a>df_sits <span class="op">%&gt;%</span><span class="st"> </span>nrow</span>
<span id="cb5-4"><a href="subgroup-based-analysis.html#cb5-4"></a><span class="co">## [1] 86</span></span></code></pre></div>
</div>
<div id="truncation_distance" class="section level3 unnumbered hasAnchor">
<h3><code>truncation_distance</code><a href="subgroup-based-analysis.html#truncation_distance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The truncation distance, in km, will be applied during detection function model fitting. Typically the farthest 5 - 10% of sightings are truncated, but this needs to be balanced by sample size considerations.</p>
<p>Get candidate distances:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="subgroup-based-analysis.html#cb6-1"></a>truncation_options &lt;-<span class="st"> </span><span class="kw">quantile</span>(df_sits<span class="op">$</span>PerpDistKm, </span>
<span id="cb6-2"><a href="subgroup-based-analysis.html#cb6-2"></a>                               <span class="kw">c</span>(<span class="fl">0.90</span>,<span class="fl">0.91</span>,<span class="fl">0.92</span>,<span class="fl">0.93</span>,<span class="fl">0.94</span>,.<span class="dv">95</span>))</span>
<span id="cb6-3"><a href="subgroup-based-analysis.html#cb6-3"></a></span>
<span id="cb6-4"><a href="subgroup-based-analysis.html#cb6-4"></a>truncation_options</span>
<span id="cb6-5"><a href="subgroup-based-analysis.html#cb6-5"></a><span class="co">##      90%      91%      92%      93%      94%      95% </span></span>
<span id="cb6-6"><a href="subgroup-based-analysis.html#cb6-6"></a><span class="co">## 4.249637 4.350266 4.403387 4.486396 4.881672 5.217843</span></span></code></pre></div>
<p>Plot these options:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="subgroup-based-analysis.html#cb7-1"></a><span class="kw">hist</span>(df_sits<span class="op">$</span>PerpDistKm, <span class="dt">main=</span><span class="st">&#39;Detection distances&#39;</span>)</span>
<span id="cb7-2"><a href="subgroup-based-analysis.html#cb7-2"></a><span class="kw">abline</span>(<span class="dt">v=</span>truncation_options, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>, <span class="dt">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Get sample size remaining for each candidate distance:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="subgroup-based-analysis.html#cb8-1"></a><span class="kw">data.frame</span>(<span class="dt">km =</span> truncation_options, </span>
<span id="cb8-2"><a href="subgroup-based-analysis.html#cb8-2"></a>           <span class="dt">n =</span> <span class="kw">sapply</span>(truncation_options, </span>
<span id="cb8-3"><a href="subgroup-based-analysis.html#cb8-3"></a>                      <span class="cf">function</span>(x){<span class="kw">length</span>(<span class="kw">which</span>(df_sits<span class="op">$</span>PerpDistKm <span class="op">&lt;=</span><span class="st"> </span>x))}))</span>
<span id="cb8-4"><a href="subgroup-based-analysis.html#cb8-4"></a><span class="co">##           km  n</span></span>
<span id="cb8-5"><a href="subgroup-based-analysis.html#cb8-5"></a><span class="co">## 90% 4.249637 77</span></span>
<span id="cb8-6"><a href="subgroup-based-analysis.html#cb8-6"></a><span class="co">## 91% 4.350266 78</span></span>
<span id="cb8-7"><a href="subgroup-based-analysis.html#cb8-7"></a><span class="co">## 92% 4.403387 79</span></span>
<span id="cb8-8"><a href="subgroup-based-analysis.html#cb8-8"></a><span class="co">## 93% 4.486396 80</span></span>
<span id="cb8-9"><a href="subgroup-based-analysis.html#cb8-9"></a><span class="co">## 94% 4.881672 80</span></span>
<span id="cb8-10"><a href="subgroup-based-analysis.html#cb8-10"></a><span class="co">## 95% 5.217843 81</span></span></code></pre></div>
<p>Based on these results, we will choose a truncation distance of 4.5 km.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="subgroup-based-analysis.html#cb9-1"></a>truncation_distance &lt;-<span class="st"> </span><span class="fl">4.5</span></span></code></pre></div>
</div>
<div id="ss" class="section level3 unnumbered hasAnchor">
<h3><code>ss</code><a href="subgroup-based-analysis.html#ss" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is a numeric vector of subgroup school sizes. The function will find this vector’s geometric mean and bootstrapped CV. In Bradford et al. (2020), school size data come from all Phase 1 and Phase 2 estimates of subgroup sizes from 2010 onwards. In the processed <code>cruz</code> object, each of those estimates is the geometric mean of repeat estimates from separate observers.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="subgroup-based-analysis.html#cb10-1"></a>ss  &lt;-</span>
<span id="cb10-2"><a href="subgroup-based-analysis.html#cb10-2"></a><span class="st">  </span>cruz<span class="op">$</span>cohort<span class="op">$</span>all<span class="op">$</span>subgroups<span class="op">$</span>subgroups <span class="op">%&gt;%</span></span>
<span id="cb10-3"><a href="subgroup-based-analysis.html#cb10-3"></a><span class="st">  </span><span class="kw">filter</span>(lubridate<span class="op">::</span><span class="kw">year</span>(DateTime) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2011</span>,</span>
<span id="cb10-4"><a href="subgroup-based-analysis.html#cb10-4"></a>         Lat <span class="op">&gt;=</span><span class="st"> </span><span class="dv">5</span>, Lat <span class="op">&lt;=</span><span class="st"> </span><span class="dv">40</span>, Lon <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-185</span>, Lon <span class="op">&lt;=</span><span class="st"> </span><span class="dv">-120</span>,</span>
<span id="cb10-5"><a href="subgroup-based-analysis.html#cb10-5"></a>         Species <span class="op">==</span><span class="st"> &#39;033&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb10-6"><a href="subgroup-based-analysis.html#cb10-6"></a><span class="st">  </span><span class="kw">pull</span>(GSBest_geom)</span>
<span id="cb10-7"><a href="subgroup-based-analysis.html#cb10-7"></a>  </span>
<span id="cb10-8"><a href="subgroup-based-analysis.html#cb10-8"></a>ss <span class="op">%&gt;%</span><span class="st"> </span>length</span>
<span id="cb10-9"><a href="subgroup-based-analysis.html#cb10-9"></a><span class="co">## [1] 183</span></span>
<span id="cb10-10"><a href="subgroup-based-analysis.html#cb10-10"></a></span>
<span id="cb10-11"><a href="subgroup-based-analysis.html#cb10-11"></a>ss</span>
<span id="cb10-12"><a href="subgroup-based-analysis.html#cb10-12"></a><span class="co">##   [1]  5.00  7.00  1.00  1.00  1.00  1.33  2.00  2.75  2.67  1.00  6.00  1.00</span></span>
<span id="cb10-13"><a href="subgroup-based-analysis.html#cb10-13"></a><span class="co">##  [13]  2.00 18.50  1.00  4.00  5.00  2.00  1.00  4.00  4.50  2.50  2.00  2.00</span></span>
<span id="cb10-14"><a href="subgroup-based-analysis.html#cb10-14"></a><span class="co">##  [25]  1.00  1.00  5.00  1.00  4.00  1.00  1.00  1.00  1.00  1.00  1.00  2.00</span></span>
<span id="cb10-15"><a href="subgroup-based-analysis.html#cb10-15"></a><span class="co">##  [37]  2.00  1.00  4.00  9.83  2.50  4.75  8.25  3.00  2.00  3.00  3.67  3.50</span></span>
<span id="cb10-16"><a href="subgroup-based-analysis.html#cb10-16"></a><span class="co">##  [49]  4.50  2.00  1.00  1.00  2.00  1.00  1.00  1.00  1.00  1.00  2.00  1.00</span></span>
<span id="cb10-17"><a href="subgroup-based-analysis.html#cb10-17"></a><span class="co">##  [61]  1.00  1.00  2.00  3.00  2.00  1.50  2.67  1.33  2.00  6.00  4.33  2.00</span></span>
<span id="cb10-18"><a href="subgroup-based-analysis.html#cb10-18"></a><span class="co">##  [73]  1.00  3.00  5.00  5.80  4.00  1.00  2.00  2.00  4.00  4.50  2.00  2.00</span></span>
<span id="cb10-19"><a href="subgroup-based-analysis.html#cb10-19"></a><span class="co">##  [85]  2.00  4.50  2.00  1.00  2.00  1.00  1.00  2.00  2.00  1.50  4.50  1.00</span></span>
<span id="cb10-20"><a href="subgroup-based-analysis.html#cb10-20"></a><span class="co">##  [97]  1.00  3.33  3.00  2.00  2.00  7.50  5.00  4.00  3.67  2.00  3.00  2.00</span></span>
<span id="cb10-21"><a href="subgroup-based-analysis.html#cb10-21"></a><span class="co">## [109]  8.50  8.00  4.00  2.00  1.00  1.00  4.00  4.00  2.00  1.00  2.00  6.00</span></span>
<span id="cb10-22"><a href="subgroup-based-analysis.html#cb10-22"></a><span class="co">## [121]  2.00  2.00  2.50  1.00  1.00  1.00  1.00  1.00  2.00  2.00  1.00  1.00</span></span>
<span id="cb10-23"><a href="subgroup-based-analysis.html#cb10-23"></a><span class="co">## [133]  1.00  1.00  1.00  1.00  1.00  2.00  1.00  2.00  2.00  2.00  1.00  4.00</span></span>
<span id="cb10-24"><a href="subgroup-based-analysis.html#cb10-24"></a><span class="co">## [145]  7.50  1.50  2.00  1.00  1.00  1.00  1.00  2.00  1.00  2.00  3.00  3.00</span></span>
<span id="cb10-25"><a href="subgroup-based-analysis.html#cb10-25"></a><span class="co">## [157]  2.00  3.00  1.50  1.00  1.00  3.00  2.00  4.00  1.00  1.00  1.00  2.00</span></span>
<span id="cb10-26"><a href="subgroup-based-analysis.html#cb10-26"></a><span class="co">## [169]  2.00  4.00  2.00  2.00  1.00  1.00  3.00  1.00  3.00  2.50  2.00  2.00</span></span>
<span id="cb10-27"><a href="subgroup-based-analysis.html#cb10-27"></a><span class="co">## [181]  1.00  1.00  1.00</span></span></code></pre></div>
</div>
<div id="cruz10" class="section level3 unnumbered hasAnchor">
<h3><code>cruz10</code><a href="subgroup-based-analysis.html#cruz10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is a processed <code>cruz</code> object with short segment lengths, ideally 10 km or less (hence the 10 in the input name). This <code>cruz</code> object will be used to estimate <em>Rg(0)</em>, i.e., the relative trackline detection probability (see its chapter). <code>LTabundR</code> comes with a built-in dataset we can use for this purpose:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="subgroup-based-analysis.html#cb11-1"></a><span class="kw">data</span>(<span class="st">&quot;noaa_10km_1986_2020&quot;</span>)</span>
<span id="cb11-2"><a href="subgroup-based-analysis.html#cb11-2"></a>cruz10 &lt;-<span class="st"> </span>noaa_10km_<span class="dv">1986</span>_<span class="dv">2020</span></span></code></pre></div>
<p>The code used to generate this dataset can be seen by pulling up the help documentation: <code>?noaa_10km_1986_2020</code>.</p>
</div>
<div id="g0_spp" class="section level3 unnumbered hasAnchor">
<h3><code>g0_spp</code><a href="subgroup-based-analysis.html#g0_spp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is a character vector of species code(s) to use to estimate <em>Rg(0)</em>. In most cases this will be a single species, e.g., <code>"033"</code> for false killer whales.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="subgroup-based-analysis.html#cb12-1"></a>g0_spp &lt;-<span class="st"> &#39;033&#39;</span></span></code></pre></div>
</div>
<div id="g0_truncation" class="section level3 unnumbered hasAnchor">
<h3><code>g0_truncation</code><a href="subgroup-based-analysis.html#g0_truncation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The truncation distance to use when estimating Rg(0). In Bradford et al. (2020) this is 5.5 km.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="subgroup-based-analysis.html#cb13-1"></a>g0_truncation &lt;-<span class="st"> </span><span class="fl">5.5</span></span></code></pre></div>
</div>
<div id="g0_pool_bft" class="section level3 unnumbered hasAnchor">
<h3><code>g0_pool_bft</code><a href="subgroup-based-analysis.html#g0_pool_bft" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A way to specify that low Beaufort sea states, which are typically rare in open-ocean surveys, should be pooled. This step may be needed in order to achieve a monotonic decline in the <em>g(0)</em> ~ Bft relationship, but the default is <code>NULL</code>, i.e., no pooling. If <code>g0_pool_bft</code> is the character string <code>"01"</code>, Beaufort states 1 will be pooled into state 0. If <code>g0_pool_bft</code> is the character string <code>"012"</code>, Beaufort states 1 and 2 will be pooled into state 0.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="subgroup-based-analysis.html#cb14-1"></a>g0_pool_bft =<span class="st"> </span><span class="ot">NULL</span></span></code></pre></div>
</div>
<div id="g0_jackknife_fraction" class="section level3 unnumbered hasAnchor">
<h3><code>g0_jackknife_fraction</code><a href="subgroup-based-analysis.html#g0_jackknife_fraction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The proportion of data to leave out within each jackknife permutation. The default is <code>0.1</code> (i.e., 10% of the data, yielding 10 jackknife loops), after Barlow (2015).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="subgroup-based-analysis.html#cb15-1"></a>g0_jackknife_fraction =<span class="st"> </span><span class="fl">0.1</span></span></code></pre></div>
</div>
<div id="density_segments" class="section level3 unnumbered hasAnchor">
<h3><code>density_segments</code><a href="subgroup-based-analysis.html#density_segments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The survey segments to be used in density/abundance estimation. For example, Bradford et al. (2020) used 150-km segments to estimate false killer whale density in the Hawaiian EEZ in 2017. For this we can use the 1986-2020 dataset we loaded above. Note that no filtering will be applied to these segments by the <code>lta_subgroup()</code> function, so w need to filter them ourselves first: we want only systematic segments for the Hawaiian EEZ in 2017 (specially, just cruises 1705 and 1706).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="subgroup-based-analysis.html#cb16-1"></a>cruzi &lt;-<span class="st"> </span><span class="kw">filter_cruz</span>(<span class="dt">cruz =</span> cruz,</span>
<span id="cb16-2"><a href="subgroup-based-analysis.html#cb16-2"></a>                      <span class="dt">analysis_only =</span> <span class="ot">TRUE</span>,</span>
<span id="cb16-3"><a href="subgroup-based-analysis.html#cb16-3"></a>                      <span class="dt">years =</span> <span class="dv">2017</span>,</span>
<span id="cb16-4"><a href="subgroup-based-analysis.html#cb16-4"></a>                      <span class="dt">cruises =</span> <span class="kw">c</span>(<span class="dv">1705</span>, <span class="dv">1706</span>),</span>
<span id="cb16-5"><a href="subgroup-based-analysis.html#cb16-5"></a>                      <span class="dt">regions =</span> <span class="st">&#39;HI_EEZ&#39;</span>,</span>
<span id="cb16-6"><a href="subgroup-based-analysis.html#cb16-6"></a>                      <span class="dt">bft_range =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">6</span>,</span>
<span id="cb16-7"><a href="subgroup-based-analysis.html#cb16-7"></a>                      <span class="dt">eff_types =</span> <span class="st">&#39;S&#39;</span>,</span>
<span id="cb16-8"><a href="subgroup-based-analysis.html#cb16-8"></a>                      <span class="dt">on_off =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>From this filtered cruz object, we will isolate the segments data:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="subgroup-based-analysis.html#cb17-1"></a>density_segments &lt;-<span class="st"> </span>cruzi<span class="op">$</span>cohorts<span class="op">$</span>all<span class="op">$</span>segments</span></code></pre></div>
<p>Since we do not want to stratify our analysis by smaller geostrata, such as the Main Hawaiian Islands, we will go ahead and coerce all stratum assignments to the Hawaiian EEZ geostratum:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="subgroup-based-analysis.html#cb18-1"></a>density_segments<span class="op">$</span>stratum &lt;-<span class="st"> &#39;HI_EEZ&#39;</span></span></code></pre></div>
</div>
<div id="density_das" class="section level3 unnumbered hasAnchor">
<h3><code>density_das</code><a href="subgroup-based-analysis.html#density_das" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is the complete survey data corresponding to the above segments. These data will be used to determine the proportion of survey effort occurring in each Beaufort sea state during estimation of <em>Relative g(0)</em>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="subgroup-based-analysis.html#cb19-1"></a>density_das &lt;-<span class="st"> </span>cruzi<span class="op">$</span>cohorts<span class="op">$</span>all<span class="op">$</span>das</span></code></pre></div>
</div>
<div id="density_sightings" class="section level3 unnumbered hasAnchor">
<h3><code>density_sightings</code><a href="subgroup-based-analysis.html#density_sightings" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>These are the encounters to use in density/abundance estimation. In Bradford et al. (20120), these were the Phase 1 detections of false killer whale subgroups within the population-region-year of interest, e.g., Northwest Hawaiian Island population sightings within the Hawaiian EEZ in 2017. No filtering is applied to these sightings within <code>lta_subgroups()</code>, so make sure only the sightings you wish to use are included and nothing more.</p>
<p>In this example, since we do not have population information on hand, we will not filter detections to a specific population. Instead, we will estimate abundance of all false killer whales within the Hawaiian EEZ:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="subgroup-based-analysis.html#cb20-1"></a>density_sightings  &lt;-</span>
<span id="cb20-2"><a href="subgroup-based-analysis.html#cb20-2"></a><span class="st">  </span>cruz<span class="op">$</span>cohorts<span class="op">$</span>all<span class="op">$</span>subgroups<span class="op">$</span>subgroups <span class="op">%&gt;%</span></span>
<span id="cb20-3"><a href="subgroup-based-analysis.html#cb20-3"></a><span class="st">  </span><span class="kw">filter</span>(EffType <span class="op">==</span><span class="st"> &#39;S&#39;</span>,</span>
<span id="cb20-4"><a href="subgroup-based-analysis.html#cb20-4"></a>         OnEffort <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>,</span>
<span id="cb20-5"><a href="subgroup-based-analysis.html#cb20-5"></a>         lubridate<span class="op">::</span><span class="kw">year</span>(DateTime) <span class="op">==</span><span class="st"> </span><span class="dv">2017</span>,</span>
<span id="cb20-6"><a href="subgroup-based-analysis.html#cb20-6"></a>         PerpDist <span class="op">&lt;=</span><span class="st"> </span>truncation_distance,</span>
<span id="cb20-7"><a href="subgroup-based-analysis.html#cb20-7"></a>         Species <span class="op">==</span><span class="st"> &#39;033&#39;</span>,</span>
<span id="cb20-8"><a href="subgroup-based-analysis.html#cb20-8"></a>         Phase <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb20-9"><a href="subgroup-based-analysis.html#cb20-9"></a></span>
<span id="cb20-10"><a href="subgroup-based-analysis.html#cb20-10"></a>density_sightings <span class="op">%&gt;%</span><span class="st"> </span>nrow</span>
<span id="cb20-11"><a href="subgroup-based-analysis.html#cb20-11"></a><span class="co">## [1] 32</span></span>
<span id="cb20-12"><a href="subgroup-based-analysis.html#cb20-12"></a></span>
<span id="cb20-13"><a href="subgroup-based-analysis.html#cb20-13"></a>density_sightings <span class="op">%&gt;%</span><span class="st"> </span>head</span>
<span id="cb20-14"><a href="subgroup-based-analysis.html#cb20-14"></a><span class="co">##   Cruise       Date            DateTime      Lat       Lon OnEffort Bft EffType</span></span>
<span id="cb20-15"><a href="subgroup-based-analysis.html#cb20-15"></a><span class="co">## 1   1705 2017-09-21 2017-09-21 14:17:27 20.04283 -161.9177     TRUE   5       S</span></span>
<span id="cb20-16"><a href="subgroup-based-analysis.html#cb20-16"></a><span class="co">## 2   1705 2017-09-21 2017-09-21 14:39:40 20.06017 -161.9840     TRUE   5       S</span></span>
<span id="cb20-17"><a href="subgroup-based-analysis.html#cb20-17"></a><span class="co">## 3   1705 2017-09-29 2017-09-29 13:22:08 23.55750 -175.8527     TRUE   1       S</span></span>
<span id="cb20-18"><a href="subgroup-based-analysis.html#cb20-18"></a><span class="co">## 4   1705 2017-09-29 2017-09-29 13:26:05 23.56050 -175.8643     TRUE   1       S</span></span>
<span id="cb20-19"><a href="subgroup-based-analysis.html#cb20-19"></a><span class="co">## 5   1705 2017-09-29 2017-09-29 13:26:43 23.56083 -175.8662     TRUE   1       S</span></span>
<span id="cb20-20"><a href="subgroup-based-analysis.html#cb20-20"></a><span class="co">## 6   1705 2017-09-29 2017-09-29 13:32:33 23.56517 -175.8832     TRUE   1       S</span></span>
<span id="cb20-21"><a href="subgroup-based-analysis.html#cb20-21"></a><span class="co">##   SightNo Species SubGrp Angle   RadDist seg_id  PerpDist GSBest GSH  GSL</span></span>
<span id="cb20-22"><a href="subgroup-based-analysis.html#cb20-22"></a><span class="co">## 1     064     033      A    14 5.0374102   1601 1.2186598   3.00   4 2.00</span></span>
<span id="cb20-23"><a href="subgroup-based-analysis.html#cb20-23"></a><span class="co">## 2     064     033      B    24 3.1483814   1601 1.2805621   3.67   6 2.33</span></span>
<span id="cb20-24"><a href="subgroup-based-analysis.html#cb20-24"></a><span class="co">## 3     073     033      A    49 3.3706200   1609 2.5438392   2.00   3 1.00</span></span>
<span id="cb20-25"><a href="subgroup-based-analysis.html#cb20-25"></a><span class="co">## 4     073     033      B    68 0.6852359   1609 0.6353397   1.00   2 1.00</span></span>
<span id="cb20-26"><a href="subgroup-based-analysis.html#cb20-26"></a><span class="co">## 5     073     033      C    40 0.3703978   1609 0.2380871   1.00   1 1.00</span></span>
<span id="cb20-27"><a href="subgroup-based-analysis.html#cb20-27"></a><span class="co">## 6     073     033      E    89 2.9817023   1609 2.9812482   1.00   2 1.00</span></span>
<span id="cb20-28"><a href="subgroup-based-analysis.html#cb20-28"></a><span class="co">##   GSBest_geom GSH_geom GSL_geom  use stratum_HI_EEZ stratum_OtherCNP</span></span>
<span id="cb20-29"><a href="subgroup-based-analysis.html#cb20-29"></a><span class="co">## 1        3.00        4     2.00 TRUE           TRUE             TRUE</span></span>
<span id="cb20-30"><a href="subgroup-based-analysis.html#cb20-30"></a><span class="co">## 2        3.67        6     2.33 TRUE           TRUE             TRUE</span></span>
<span id="cb20-31"><a href="subgroup-based-analysis.html#cb20-31"></a><span class="co">## 3        2.00        3     1.00 TRUE           TRUE             TRUE</span></span>
<span id="cb20-32"><a href="subgroup-based-analysis.html#cb20-32"></a><span class="co">## 4        1.00        2     1.00 TRUE           TRUE             TRUE</span></span>
<span id="cb20-33"><a href="subgroup-based-analysis.html#cb20-33"></a><span class="co">## 5        1.00        1     1.00 TRUE           TRUE             TRUE</span></span>
<span id="cb20-34"><a href="subgroup-based-analysis.html#cb20-34"></a><span class="co">## 6        1.00        2     1.00 TRUE           TRUE             TRUE</span></span>
<span id="cb20-35"><a href="subgroup-based-analysis.html#cb20-35"></a><span class="co">##   stratum_MHI stratum Phase</span></span>
<span id="cb20-36"><a href="subgroup-based-analysis.html#cb20-36"></a><span class="co">## 1       FALSE  HI_EEZ     1</span></span>
<span id="cb20-37"><a href="subgroup-based-analysis.html#cb20-37"></a><span class="co">## 2       FALSE  HI_EEZ     1</span></span>
<span id="cb20-38"><a href="subgroup-based-analysis.html#cb20-38"></a><span class="co">## 3       FALSE  HI_EEZ     1</span></span>
<span id="cb20-39"><a href="subgroup-based-analysis.html#cb20-39"></a><span class="co">## 4       FALSE  HI_EEZ     1</span></span>
<span id="cb20-40"><a href="subgroup-based-analysis.html#cb20-40"></a><span class="co">## 5       FALSE  HI_EEZ     1</span></span>
<span id="cb20-41"><a href="subgroup-based-analysis.html#cb20-41"></a><span class="co">## 6       FALSE  HI_EEZ     1</span></span></code></pre></div>
<p>As above, let’s make sure the geostratum assignments for these sightings are simple:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="subgroup-based-analysis.html#cb21-1"></a>density_segments<span class="op">$</span>stratum &lt;-<span class="st"> &#39;HI_EEZ&#39;</span></span></code></pre></div>
</div>
<div id="abundance_area" class="section level3 unnumbered hasAnchor">
<h3><code>abundance_area</code><a href="subgroup-based-analysis.html#abundance_area" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is the area, in square km, of the region of interest. The density estimate will be scaled by this area.</p>
<p>We have two options for finding this area. The first is to draw the area from our <code>cohort$strata</code> slot:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="subgroup-based-analysis.html#cb22-1"></a>cruz<span class="op">$</span>strata<span class="op">$</span>area[cruz<span class="op">$</span>strata<span class="op">$</span>stratum <span class="op">==</span><span class="st"> &#39;HI_EEZ&#39;</span>]</span>
<span id="cb22-2"><a href="subgroup-based-analysis.html#cb22-2"></a><span class="co">## [1] 2474596</span></span></code></pre></div>
<p>The second is to calculate it ourselves using the <code>LTabundR</code> function <code>strata_area()</code>. This second option will be useful if your study area is a complicated combination/substraction of multiple geostrata.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="subgroup-based-analysis.html#cb23-1"></a><span class="kw">data</span>(strata_cnp)</span>
<span id="cb23-2"><a href="subgroup-based-analysis.html#cb23-2"></a></span>
<span id="cb23-3"><a href="subgroup-based-analysis.html#cb23-3"></a>abundance_area &lt;-<span class="st"> </span></span>
<span id="cb23-4"><a href="subgroup-based-analysis.html#cb23-4"></a><span class="st">  </span><span class="kw">strata_area</span>(<span class="dt">strata_all =</span> strata_cnp,</span>
<span id="cb23-5"><a href="subgroup-based-analysis.html#cb23-5"></a>              <span class="dt">strata_keep =</span> <span class="st">&#39;HI_EEZ&#39;</span>)<span class="op">$</span>km2</span></code></pre></div>
<p><img src="vignette_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="subgroup-based-analysis.html#cb24-1"></a></span>
<span id="cb24-2"><a href="subgroup-based-analysis.html#cb24-2"></a>abundance_area</span>
<span id="cb24-3"><a href="subgroup-based-analysis.html#cb24-3"></a><span class="co">## [1] 2474596</span></span></code></pre></div>
</div>
<div id="remaining-inputs" class="section level3 unnumbered hasAnchor">
<h3>Remaining inputs<a href="subgroup-based-analysis.html#remaining-inputs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong><code>iterations</code></strong>: Number of iterations to use in the various CV bootstrapping procedures occurring throughout this function, specifically: Effective Strip Half-Width CV estimation, school size CV estimation, weighted g(0) CV estimation, and encounter rate estimation.</p>
<p><strong><code>output_dir</code></strong>: The path in which results RData files should be stored. If left "", the current working directory will be used.</p>
<p><strong><code>toplot</code></strong>: A Boolean, with default FALSE, indicating whether to plot various aspects of the analysis.</p>
<p><strong><code>verbose</code></strong>: A Boolean, with default TRUE, indicating whether to print status updates to the Console.</p>
<p><strong><code>density_bootstraps</code></strong>: Number of bootstrap iterations to use for the CV estimate of density and abundance specifically. This input allows this final step to use a different (typically larger) iteration size than the iterations input above.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="subgroup-based-analysis.html#cb25-1"></a><span class="kw">save</span>(results_subgroup, <span class="dt">file=</span><span class="st">&#39;results_subgroup.RData&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="subgroup-based-analysis.html#cb26-1"></a><span class="kw">load</span>(<span class="st">&#39;results_subgroup.RData&#39;</span>)</span></code></pre></div>
</div>
</div>
<div id="outputs-1" class="section level2 unnumbered hasAnchor">
<h2>Outputs<a href="subgroup-based-analysis.html#outputs-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The function returns a <code>list</code> with many slots, including estimates of density and abundance – along with estimates of intermediate parameters – with a CV derived from a bootstrapping routine. To demonstrate this output, we will use results from a call with only 10 bootstrap iterations.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="subgroup-based-analysis.html#cb27-1"></a>results_subgroup <span class="op">%&gt;%</span><span class="st"> </span>names</span>
<span id="cb27-2"><a href="subgroup-based-analysis.html#cb27-2"></a><span class="co">##  [1] &quot;D&quot;                  &quot;D_CV&quot;               &quot;D_L95&quot;             </span></span>
<span id="cb27-3"><a href="subgroup-based-analysis.html#cb27-3"></a><span class="co">##  [4] &quot;D_U95&quot;              &quot;N&quot;                  &quot;N_CV&quot;              </span></span>
<span id="cb27-4"><a href="subgroup-based-analysis.html#cb27-4"></a><span class="co">##  [7] &quot;N_L95&quot;              &quot;N_U95&quot;              &quot;ER&quot;                </span></span>
<span id="cb27-5"><a href="subgroup-based-analysis.html#cb27-5"></a><span class="co">## [10] &quot;ss&quot;                 &quot;n&quot;                  &quot;L&quot;                 </span></span>
<span id="cb27-6"><a href="subgroup-based-analysis.html#cb27-6"></a><span class="co">## [13] &quot;n_segments&quot;         &quot;g0&quot;                 &quot;g0_cv&quot;             </span></span>
<span id="cb27-7"><a href="subgroup-based-analysis.html#cb27-7"></a><span class="co">## [16] &quot;g0_details&quot;         &quot;df&quot;                 &quot;bootstraps&quot;        </span></span>
<span id="cb27-8"><a href="subgroup-based-analysis.html#cb27-8"></a><span class="co">## [19] &quot;iterations&quot;         &quot;density_bootstraps&quot;</span></span></code></pre></div>
<p>Most of these slots hold best-estimates of parameters or sample size details:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="subgroup-based-analysis.html#cb28-1"></a>results_subgroup[<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>, <span class="dv">19</span><span class="op">:</span><span class="dv">20</span>)]</span>
<span id="cb28-2"><a href="subgroup-based-analysis.html#cb28-2"></a><span class="co">## $D</span></span>
<span id="cb28-3"><a href="subgroup-based-analysis.html#cb28-3"></a><span class="co">##           1 </span></span>
<span id="cb28-4"><a href="subgroup-based-analysis.html#cb28-4"></a><span class="co">## 0.001663263 </span></span>
<span id="cb28-5"><a href="subgroup-based-analysis.html#cb28-5"></a><span class="co">## </span></span>
<span id="cb28-6"><a href="subgroup-based-analysis.html#cb28-6"></a><span class="co">## $D_CV</span></span>
<span id="cb28-7"><a href="subgroup-based-analysis.html#cb28-7"></a><span class="co">##        1 </span></span>
<span id="cb28-8"><a href="subgroup-based-analysis.html#cb28-8"></a><span class="co">## 1.344861 </span></span>
<span id="cb28-9"><a href="subgroup-based-analysis.html#cb28-9"></a><span class="co">## </span></span>
<span id="cb28-10"><a href="subgroup-based-analysis.html#cb28-10"></a><span class="co">## $D_L95</span></span>
<span id="cb28-11"><a href="subgroup-based-analysis.html#cb28-11"></a><span class="co">## [1] 0.0005004478</span></span>
<span id="cb28-12"><a href="subgroup-based-analysis.html#cb28-12"></a><span class="co">## </span></span>
<span id="cb28-13"><a href="subgroup-based-analysis.html#cb28-13"></a><span class="co">## $D_U95</span></span>
<span id="cb28-14"><a href="subgroup-based-analysis.html#cb28-14"></a><span class="co">## [1] 0.01547307</span></span>
<span id="cb28-15"><a href="subgroup-based-analysis.html#cb28-15"></a><span class="co">## </span></span>
<span id="cb28-16"><a href="subgroup-based-analysis.html#cb28-16"></a><span class="co">## $N</span></span>
<span id="cb28-17"><a href="subgroup-based-analysis.html#cb28-17"></a><span class="co">## [1] 4116</span></span>
<span id="cb28-18"><a href="subgroup-based-analysis.html#cb28-18"></a><span class="co">## </span></span>
<span id="cb28-19"><a href="subgroup-based-analysis.html#cb28-19"></a><span class="co">## $N_CV</span></span>
<span id="cb28-20"><a href="subgroup-based-analysis.html#cb28-20"></a><span class="co">## [1] 1.344829</span></span>
<span id="cb28-21"><a href="subgroup-based-analysis.html#cb28-21"></a><span class="co">## </span></span>
<span id="cb28-22"><a href="subgroup-based-analysis.html#cb28-22"></a><span class="co">## $N_L95</span></span>
<span id="cb28-23"><a href="subgroup-based-analysis.html#cb28-23"></a><span class="co">## [1] 1238.357</span></span>
<span id="cb28-24"><a href="subgroup-based-analysis.html#cb28-24"></a><span class="co">## </span></span>
<span id="cb28-25"><a href="subgroup-based-analysis.html#cb28-25"></a><span class="co">## $N_U95</span></span>
<span id="cb28-26"><a href="subgroup-based-analysis.html#cb28-26"></a><span class="co">## [1] 38290</span></span>
<span id="cb28-27"><a href="subgroup-based-analysis.html#cb28-27"></a><span class="co">## </span></span>
<span id="cb28-28"><a href="subgroup-based-analysis.html#cb28-28"></a><span class="co">## $ER</span></span>
<span id="cb28-29"><a href="subgroup-based-analysis.html#cb28-29"></a><span class="co">## [1] 0.001860071</span></span>
<span id="cb28-30"><a href="subgroup-based-analysis.html#cb28-30"></a><span class="co">## </span></span>
<span id="cb28-31"><a href="subgroup-based-analysis.html#cb28-31"></a><span class="co">## $ss</span></span>
<span id="cb28-32"><a href="subgroup-based-analysis.html#cb28-32"></a><span class="co">## [1] 2.466557</span></span>
<span id="cb28-33"><a href="subgroup-based-analysis.html#cb28-33"></a><span class="co">## </span></span>
<span id="cb28-34"><a href="subgroup-based-analysis.html#cb28-34"></a><span class="co">## $n</span></span>
<span id="cb28-35"><a href="subgroup-based-analysis.html#cb28-35"></a><span class="co">## [1] 32</span></span>
<span id="cb28-36"><a href="subgroup-based-analysis.html#cb28-36"></a><span class="co">## </span></span>
<span id="cb28-37"><a href="subgroup-based-analysis.html#cb28-37"></a><span class="co">## $L</span></span>
<span id="cb28-38"><a href="subgroup-based-analysis.html#cb28-38"></a><span class="co">## [1] 17203.64</span></span>
<span id="cb28-39"><a href="subgroup-based-analysis.html#cb28-39"></a><span class="co">## </span></span>
<span id="cb28-40"><a href="subgroup-based-analysis.html#cb28-40"></a><span class="co">## $n_segments</span></span>
<span id="cb28-41"><a href="subgroup-based-analysis.html#cb28-41"></a><span class="co">## [1] 136</span></span>
<span id="cb28-42"><a href="subgroup-based-analysis.html#cb28-42"></a><span class="co">## </span></span>
<span id="cb28-43"><a href="subgroup-based-analysis.html#cb28-43"></a><span class="co">## $g0</span></span>
<span id="cb28-44"><a href="subgroup-based-analysis.html#cb28-44"></a><span class="co">## [1] 0.571</span></span>
<span id="cb28-45"><a href="subgroup-based-analysis.html#cb28-45"></a><span class="co">## </span></span>
<span id="cb28-46"><a href="subgroup-based-analysis.html#cb28-46"></a><span class="co">## $g0_cv</span></span>
<span id="cb28-47"><a href="subgroup-based-analysis.html#cb28-47"></a><span class="co">## [1] 0.365</span></span>
<span id="cb28-48"><a href="subgroup-based-analysis.html#cb28-48"></a><span class="co">## </span></span>
<span id="cb28-49"><a href="subgroup-based-analysis.html#cb28-49"></a><span class="co">## $iterations</span></span>
<span id="cb28-50"><a href="subgroup-based-analysis.html#cb28-50"></a><span class="co">## [1] 10</span></span>
<span id="cb28-51"><a href="subgroup-based-analysis.html#cb28-51"></a><span class="co">## </span></span>
<span id="cb28-52"><a href="subgroup-based-analysis.html#cb28-52"></a><span class="co">## $density_bootstraps</span></span>
<span id="cb28-53"><a href="subgroup-based-analysis.html#cb28-53"></a><span class="co">## [1] 10000</span></span></code></pre></div>
<p>The <code>g0_details</code> slot includes the results from the <code>g0_model()</code> and <code>g0_weighted()</code> functions called internally by <code>lta_subgroup()</code>. See those functions’ documentation pages for details.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="subgroup-based-analysis.html#cb29-1"></a>results_subgroup<span class="op">$</span>g0_details <span class="op">%&gt;%</span><span class="st"> </span>names</span>
<span id="cb29-2"><a href="subgroup-based-analysis.html#cb29-2"></a><span class="co">## [1] &quot;Rg0&quot;       &quot;gam&quot;       &quot;jackknife&quot; &quot;summary&quot;   &quot;sightings&quot; &quot;segments&quot;</span></span></code></pre></div>
<p>The <code>df</code> slot includes details of the detection function fit. See the documentation for <code>df_plot()</code> for details.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="subgroup-based-analysis.html#cb30-1"></a>results_subgroup<span class="op">$</span>df <span class="op">%&gt;%</span><span class="st"> </span>names</span>
<span id="cb30-2"><a href="subgroup-based-analysis.html#cb30-2"></a><span class="co">## [1] &quot;best_models&quot;  &quot;all_models&quot;   &quot;best_objects&quot; &quot;sightings&quot;</span></span></code></pre></div>
<p>The <code>bootstraps</code> slot has the bootstrapped values for various parameters, in case they are useful for troubleshooting, subsequent analyses, and/or plotting:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="subgroup-based-analysis.html#cb31-1"></a>results_subgroup<span class="op">$</span>bootstraps <span class="op">%&gt;%</span><span class="st"> </span>names</span>
<span id="cb31-2"><a href="subgroup-based-analysis.html#cb31-2"></a><span class="co">## [1] &quot;esw&quot; &quot;ss&quot;  &quot;g0&quot;  &quot;er&quot;  &quot;D&quot;   &quot;N&quot;</span></span></code></pre></div>
<p>Some examples:</p>
<p><img src="vignette_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p><img src="vignette_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p><img src="vignette_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
</div>
<div id="behind-the-scenes-2" class="section level2 unnumbered hasAnchor">
<h2>Behind the scenes<a href="subgroup-based-analysis.html#behind-the-scenes-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This function performs the following operations:</p>
<ol style="list-style-type: decimal">
<li><p>Fits a detection function to <code>df_sits</code> without covariates, using the <code>LTabundR</code> function <code>df_fit()</code>, in order to estimate the effective strip half-width (ESW).</p></li>
<li><p>Conducts bootstrap re-sampling of the detection function fitting routine in order to estimate the CV of ESW.</p></li>
<li><p>Estimates the geometric mean of subgroup school size based on the <code>ss</code> input.</p></li>
<li><p>Creates a bootstrap-resampled distribution of subgroup school sizes, with which CV is estimated.</p></li>
<li><p>Models the <em>Relative g(0)</em> in different survey conditions using the <code>LTabundR</code> function <code>g0_model()</code>. This function also estimates the CV of the <em>Rg(0)</em> estimate in each Beaufort sea state using jackknife resampling.</p></li>
<li><p>Estimates the encounter rate (subgroup detections / trackline surveyed).</p></li>
<li><p>Creates a bootstrap-resampled distribution of encounter rate estimates.</p></li>
<li><p>Calculates a weighted <em>g(0)</em> estimate according to the proportion of effort occurring in each Beaufort sea state, then uses an automated parameter optimization routine (see details in <code>LTabundR</code> function <code>g0_weighted()</code>) to estimate the CV of the weighted <em>g(0)</em> estimate.</p></li>
<li><p>Creates a bootstrap-resampled distribution of the weighted <em>g(0)</em> estimate.</p></li>
<li><p>Estimates density using the best estimates of effective strip half-width, school size, <em>g(0)</em>, and the encounter rate.</p></li>
<li><p>Estimates abundance by scaling the density estimate by the provided abundance_area.</p></li>
<li><p>Creates a bootstrap-resampled distribution of the density estimate by iteratively drawing values from the resampled distributions of the constituent parameters of the density equation.</p></li>
<li><p>Creates a bootstrap-resampled distribtion of the abundance estimate by scaling the density distribution by abundance_area.</p></li>
</ol>
<p>Note that this approach could theoretically be used for other species that occur in subgroups.</p>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="trend-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tables.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/emk-noaa/emk-noaa.github.io11-subgroups.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["vignette.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
