<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 11 Subgroup-based analysis | User’s guide for LTabundR</title>
  <meta name="description" content="vignette" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content=" 11 Subgroup-based analysis | User’s guide for LTabundR" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="vignette" />
  <meta name="github-repo" content="emk-noaa/emk-noaa.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 11 Subgroup-based analysis | User’s guide for LTabundR" />
  
  <meta name="twitter:description" content="vignette" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="trend-analysis.html"/>
<link rel="next" href="diagnostic-plots.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.31.1/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/dt-ext-fixedcolumns-1.13.6/css/fixedColumns.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-fixedcolumns-1.13.6/js/dataTables.fixedColumns.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.0/leaflet.js"></script>
<script src="libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Users's guide for <kbd>LTabundR</kbd></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a></li>
<li class="part"><span><b>I Data processing</b></span></li>
<li class="chapter" data-level="1" data-path="settings.html"><a href="settings.html"><i class="fa fa-check"></i><b>1</b> Settings</a>
<ul>
<li class="chapter" data-level="" data-path="settings.html"><a href="settings.html#survey-strata"><i class="fa fa-check"></i>Survey strata</a></li>
<li class="chapter" data-level="" data-path="settings.html"><a href="settings.html#survey-wide-settings"><i class="fa fa-check"></i>Survey-wide settings</a></li>
<li class="chapter" data-level="" data-path="settings.html"><a href="settings.html#cohort-specific-settings"><i class="fa fa-check"></i>Cohort-specific settings</a></li>
<li class="chapter" data-level="" data-path="settings.html"><a href="settings.html#example-code"><i class="fa fa-check"></i>Example code</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="das.html"><a href="das.html"><i class="fa fa-check"></i><b>2</b> DAS editing</a>
<ul>
<li class="chapter" data-level="" data-path="das.html"><a href="das.html#reviewing-a-das-file"><i class="fa fa-check"></i>Reviewing a <code>DAS</code> file</a></li>
<li class="chapter" data-level="" data-path="das.html"><a href="das.html#staging-edits"><i class="fa fa-check"></i>Staging edits</a></li>
<li class="chapter" data-level="" data-path="das.html"><a href="das.html#applying-edits"><i class="fa fa-check"></i>Applying edits</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="processing.html"><a href="processing.html"><i class="fa fa-check"></i><b>3</b> Data processing</a>
<ul>
<li class="chapter" data-level="" data-path="processing.html"><a href="processing.html#behind-the-scenes"><i class="fa fa-check"></i>Behind the scenes</a></li>
<li class="chapter" data-level="" data-path="processing.html"><a href="processing.html#review"><i class="fa fa-check"></i>Review</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="filter.html"><a href="filter.html"><i class="fa fa-check"></i><b>4</b> Filter &amp; combine surveys</a>
<ul>
<li class="chapter" data-level="" data-path="filter.html"><a href="filter.html#filter-1"><i class="fa fa-check"></i>Filter</a></li>
<li class="chapter" data-level="" data-path="filter.html"><a href="filter.html#combine"><i class="fa fa-check"></i>Combine</a></li>
</ul></li>
<li class="part"><span><b>II Data exploration</b></span></li>
<li class="chapter" data-level="5" data-path="summarize.html"><a href="summarize.html"><i class="fa fa-check"></i><b>5</b> Summarize survey</a>
<ul>
<li class="chapter" data-level="" data-path="summarize.html"><a href="summarize.html#summarize-effort"><i class="fa fa-check"></i>Summarize effort</a></li>
<li class="chapter" data-level="" data-path="summarize.html"><a href="summarize.html#summarize-by-beaufort"><i class="fa fa-check"></i>Summarize by Beaufort</a></li>
<li class="chapter" data-level="" data-path="summarize.html"><a href="summarize.html#summarize-sightings"><i class="fa fa-check"></i>Summarize sightings</a></li>
<li class="chapter" data-level="" data-path="summarize.html"><a href="summarize.html#summarize-certain-species"><i class="fa fa-check"></i>Summarize certain species</a></li>
<li class="chapter" data-level="" data-path="summarize.html"><a href="summarize.html#cruz_explorer"><i class="fa fa-check"></i><code>cruz_explorer()</code></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>6</b> Maps</a>
<ul>
<li class="chapter" data-level="" data-path="maps.html"><a href="maps.html#publishable-maps"><i class="fa fa-check"></i>Publishable maps</a></li>
<li class="chapter" data-level="" data-path="maps.html"><a href="maps.html#interactive-maps"><i class="fa fa-check"></i>Interactive maps</a></li>
<li class="chapter" data-level="" data-path="maps.html"><a href="maps.html#interactive-dashboard"><i class="fa fa-check"></i>Interactive dashboard</a></li>
</ul></li>
<li class="part"><span><b>III Data analysis</b></span></li>
<li class="chapter" data-level="7" data-path="g0.html"><a href="g0.html"><i class="fa fa-check"></i><b>7</b> Estimating <em>g(0)</em></a>
<ul>
<li class="chapter" data-level="" data-path="g0.html"><a href="g0.html#relative-g0"><i class="fa fa-check"></i>Relative <code>g(0)</code></a></li>
<li class="chapter" data-level="" data-path="g0.html"><a href="g0.html#weighted-average-g0"><i class="fa fa-check"></i>Weighted average <code>g(0)</code></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="lta.html"><a href="lta.html"><i class="fa fa-check"></i><b>8</b> Line-transect analysis</a>
<ul>
<li class="chapter" data-level="" data-path="lta.html"><a href="lta.html#overview-2"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="" data-path="lta.html"><a href="lta.html#key-inputs"><i class="fa fa-check"></i>Key inputs</a></li>
<li class="chapter" data-level="" data-path="lta.html"><a href="lta.html#variance-estimation"><i class="fa fa-check"></i>Variance estimation</a></li>
<li class="chapter" data-level="" data-path="lta.html"><a href="lta.html#other-inputs"><i class="fa fa-check"></i>Other inputs</a></li>
<li class="chapter" data-level="" data-path="lta.html"><a href="lta.html#output"><i class="fa fa-check"></i>Output</a></li>
<li class="chapter" data-level="" data-path="lta.html"><a href="lta.html#unusual-estimate-scenarios"><i class="fa fa-check"></i>Unusual estimate scenarios</a></li>
<li class="chapter" data-level="" data-path="lta.html"><a href="lta.html#behind-the-scenes-1"><i class="fa fa-check"></i>Behind the scenes</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="destratify.html"><a href="destratify.html"><i class="fa fa-check"></i><b>9</b> Stratified analysis</a></li>
<li class="chapter" data-level="10" data-path="trend-analysis.html"><a href="trend-analysis.html"><i class="fa fa-check"></i><b>10</b> Trend analysis</a></li>
<li class="chapter" data-level="11" data-path="subgroups2.html"><a href="subgroups2.html"><i class="fa fa-check"></i><b>11</b> Subgroup-based analysis</a>
<ul>
<li class="chapter" data-level="" data-path="subgroups2.html"><a href="subgroups2.html#inputs-1"><i class="fa fa-check"></i>Inputs</a></li>
<li class="chapter" data-level="" data-path="subgroups2.html"><a href="subgroups2.html#outputs-1"><i class="fa fa-check"></i>Outputs</a></li>
<li class="chapter" data-level="" data-path="subgroups2.html"><a href="subgroups2.html#behind-the-scenes-2"><i class="fa fa-check"></i>Behind the scenes</a></li>
</ul></li>
<li class="part"><span><b>IV Results</b></span></li>
<li class="chapter" data-level="12" data-path="diagnostic-plots.html"><a href="diagnostic-plots.html"><i class="fa fa-check"></i><b>12</b> Diagnostic plots</a></li>
<li class="chapter" data-level="13" data-path="tables.html"><a href="tables.html"><i class="fa fa-check"></i><b>13</b> Tables</a>
<ul>
<li class="chapter" data-level="" data-path="tables.html"><a href="tables.html#summary-tables"><i class="fa fa-check"></i>Summary tables</a></li>
<li class="chapter" data-level="" data-path="tables.html"><a href="tables.html#appendix-tables"><i class="fa fa-check"></i>Appendix tables</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="plots.html"><a href="plots.html"><i class="fa fa-check"></i><b>14</b> Plots</a>
<ul>
<li class="chapter" data-level="" data-path="plots.html"><a href="plots.html#abundance-plots"><i class="fa fa-check"></i>Abundance plots</a></li>
<li class="chapter" data-level="" data-path="plots.html"><a href="plots.html#detection-function-plots"><i class="fa fa-check"></i>Detection function plots</a></li>
</ul></li>
<li class="part"><span><b>V Case studies</b></span></li>
<li class="chapter" data-level="15" data-path="whiceas.html"><a href="whiceas.html"><i class="fa fa-check"></i><b>15</b> WHICEAS</a>
<ul>
<li class="chapter" data-level="" data-path="whiceas.html"><a href="whiceas.html#data-processing"><i class="fa fa-check"></i>Data processing</a></li>
<li class="chapter" data-level="" data-path="whiceas.html"><a href="whiceas.html#data-exploration"><i class="fa fa-check"></i>Data exploration</a></li>
<li class="chapter" data-level="" data-path="whiceas.html"><a href="whiceas.html#rg0-2"><i class="fa fa-check"></i>Rg0</a></li>
<li class="chapter" data-level="" data-path="whiceas.html"><a href="whiceas.html#density-abundance"><i class="fa fa-check"></i>Density &amp; abundance</a></li>
<li class="chapter" data-level="" data-path="whiceas.html"><a href="whiceas.html#results"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="whiceas.html"><a href="whiceas.html#validation"><i class="fa fa-check"></i>Validation</a></li>
</ul></li>
<li class="part"><span><b>VI Appendix</b></span></li>
<li class="chapter" data-level="16" data-path="stratagallery.html"><a href="stratagallery.html"><i class="fa fa-check"></i><b>16</b> Strata gallery</a>
<ul>
<li class="chapter" data-level="" data-path="stratagallery.html"><a href="stratagallery.html#central-north-pacific"><i class="fa fa-check"></i>Central North Pacific</a></li>
<li class="chapter" data-level="" data-path="stratagallery.html"><a href="stratagallery.html#california-current"><i class="fa fa-check"></i>California Current</a></li>
<li class="chapter" data-level="" data-path="stratagallery.html"><a href="stratagallery.html#etp"><i class="fa fa-check"></i>ETP</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="segmentizing.html"><a href="segmentizing.html"><i class="fa fa-check"></i><b>17</b> Segmentizing</a>
<ul>
<li class="chapter" data-level="" data-path="segmentizing.html"><a href="segmentizing.html#approach"><i class="fa fa-check"></i>Approach</a></li>
<li class="chapter" data-level="" data-path="segmentizing.html"><a href="segmentizing.html#base-example"><i class="fa fa-check"></i>Base example</a></li>
<li class="chapter" data-level="" data-path="segmentizing.html"><a href="segmentizing.html#day-vs-equal-length"><i class="fa fa-check"></i>Day vs Equal Length</a></li>
<li class="chapter" data-level="" data-path="segmentizing.html"><a href="segmentizing.html#contiguous-vs.-non-contiguous-effort"><i class="fa fa-check"></i>Contiguous vs. non-contiguous effort</a></li>
<li class="chapter" data-level="" data-path="segmentizing.html"><a href="segmentizing.html#segment-remainder-handling"><i class="fa fa-check"></i>Segment remainder handling</a></li>
<li class="chapter" data-level="" data-path="segmentizing.html"><a href="segmentizing.html#typical-settings"><i class="fa fa-check"></i>Typical settings</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="abund9_compare.html"><a href="abund9_compare.html"><i class="fa fa-check"></i><b>18</b> <code>LTabundR</code> vs. <code>ABUND9</code></a>
<ul>
<li class="chapter" data-level="" data-path="abund9_compare.html"><a href="abund9_compare.html#differences-in-total-effort"><i class="fa fa-check"></i>Differences in total effort</a></li>
<li class="chapter" data-level="" data-path="abund9_compare.html"><a href="abund9_compare.html#differences-in-on-effort-distance"><i class="fa fa-check"></i>Differences in on-effort distance</a></li>
<li class="chapter" data-level="" data-path="abund9_compare.html"><a href="abund9_compare.html#differences-in-total-sightings"><i class="fa fa-check"></i>Differences in total sightings</a></li>
<li class="chapter" data-level="" data-path="abund9_compare.html"><a href="abund9_compare.html#differences-in-on-effort-sightings"><i class="fa fa-check"></i>Differences in on-effort sightings</a></li>
<li class="chapter" data-level="" data-path="abund9_compare.html"><a href="abund9_compare.html#differences-in-school-size-estimation"><i class="fa fa-check"></i>Differences in school size estimation</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="validation-1.html"><a href="validation-1.html"><i class="fa fa-check"></i><b>19</b> Validation</a>
<ul>
<li class="chapter" data-level="" data-path="validation-1.html"><a href="validation-1.html#data-processing-1"><i class="fa fa-check"></i>Data processing</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="spp_codes.html"><a href="spp_codes.html"><i class="fa fa-check"></i><b>20</b> NOAA/NMFS species codes</a>
<ul>
<li class="chapter" data-level="" data-path="spp_codes.html"><a href="spp_codes.html#table"><i class="fa fa-check"></i>Table</a></li>
<li class="chapter" data-level="" data-path="spp_codes.html"><a href="spp_codes.html#species_translator"><i class="fa fa-check"></i><code>species_translator()</code></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/emk-noaa/emk-noaa.github.io" target="blank">Eric & Amanda</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">User’s guide for <code>LTabundR</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="subgroups2" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number"> 11</span> Subgroup-based analysis<a href="subgroups2.html#subgroups2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>False killer whales (<em>Pseudorca crassidens</em>) are rare and occur in dispersed subgroups, which complicates conventional distance sampling approaches to line-transect analysis (<a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0090464">Bradford et al. 2014</a>). To better estimate their abundance in Hawaiian waters, the Pacific Islands Fisheries Science Center initiated a sub-group protocol referred to as the “PC Protocol”, a reference to the species’ scientific name. Data collected using the PC Protocol is then analyzed using a subgroup-based analytical approach (<a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0090464">Bradford et al. 2014</a>, <a href="https://repository.library.noaa.gov/view/noaa/24756">2020</a>).</p>
<p>An additional complication is that false killer whales in Hawaiian waters belong to three discrete populations – the Main Hawaiian Islands insular population, the Northwestern Hawaiian Islands (NWHI) population, and a pelagic population – whose ranges partially overlap, which means that population assignment cannot always be based simply on the geographic location of sightings. When geographic assignment of population is not possible, biopsy-sampled genetics or photo-identification inference, if available, is used to assign each sighting to a population <em>post-hoc</em>.</p>
<p>To accommodate these special circumstances for false killer whales (and potentially other species with subgroup structure) with an appropriate balance of flexibility and efficiency, <code>LTabundR</code> includes a function named <code>lta_subgroup()</code>, whose use looks something like this:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="subgroups2.html#cb193-1" tabindex="-1"></a><span class="fu">lta_subgroup</span>(df_sits,</span>
<span id="cb193-2"><a href="subgroups2.html#cb193-2" tabindex="-1"></a>             truncation_distance,</span>
<span id="cb193-3"><a href="subgroups2.html#cb193-3" tabindex="-1"></a>             ss,</span>
<span id="cb193-4"><a href="subgroups2.html#cb193-4" tabindex="-1"></a>             density_segments,</span>
<span id="cb193-5"><a href="subgroups2.html#cb193-5" tabindex="-1"></a>             density_das,</span>
<span id="cb193-6"><a href="subgroups2.html#cb193-6" tabindex="-1"></a>             density_sightings,</span>
<span id="cb193-7"><a href="subgroups2.html#cb193-7" tabindex="-1"></a>             <span class="at">Rg0=</span> <span class="cn">NULL</span>, </span>
<span id="cb193-8"><a href="subgroups2.html#cb193-8" tabindex="-1"></a>             <span class="at">cruz10 =</span> <span class="cn">NULL</span>,</span>
<span id="cb193-9"><a href="subgroups2.html#cb193-9" tabindex="-1"></a>             <span class="at">g0_spp =</span> <span class="cn">NULL</span>,</span>
<span id="cb193-10"><a href="subgroups2.html#cb193-10" tabindex="-1"></a>             <span class="at">g0_truncation =</span> <span class="cn">NULL</span>,</span>
<span id="cb193-11"><a href="subgroups2.html#cb193-11" tabindex="-1"></a>             <span class="at">g0_constrain_shape =</span> <span class="cn">FALSE</span>,</span>
<span id="cb193-12"><a href="subgroups2.html#cb193-12" tabindex="-1"></a>             <span class="at">g0_jackknife_fraction =</span> <span class="fl">0.1</span>,</span>
<span id="cb193-13"><a href="subgroups2.html#cb193-13" tabindex="-1"></a>             <span class="at">abundance_area =</span> <span class="cn">NULL</span>,</span>
<span id="cb193-14"><a href="subgroups2.html#cb193-14" tabindex="-1"></a>             <span class="at">iterations =</span> <span class="dv">5000</span>,</span>
<span id="cb193-15"><a href="subgroups2.html#cb193-15" tabindex="-1"></a>             <span class="at">density_bootstraps =</span> <span class="dv">10000</span>,</span>
<span id="cb193-16"><a href="subgroups2.html#cb193-16" tabindex="-1"></a>             <span class="at">output_dir =</span> <span class="cn">NULL</span>,</span>
<span id="cb193-17"><a href="subgroups2.html#cb193-17" tabindex="-1"></a>             <span class="at">toplot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb193-18"><a href="subgroups2.html#cb193-18" tabindex="-1"></a>             <span class="at">verbose =</span> <span class="cn">TRUE</span></span></code></pre></div>
<p>Note that there are several required inputs (without any defaults) as well as many optional inputs (with defaults provided).</p>
<p>We will step through each of these inputs below, using a case study in which we estimate the abundance of the pelagic false killer whale population in the Hawaiian EEZ for 2017 (<a href="https://repository.library.noaa.gov/view/noaa/24756">Bradford et al. 2020</a>).</p>
<p>Before proceeding, we recommend that you review the details of <a href="processing.html#subgroups">how subgroup data are processed</a> within the <code>LTabundR</code> framework.</p>
<div id="inputs-1" class="section level2 unnumbered hasAnchor">
<h2>Inputs<a href="subgroups2.html#inputs-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="df_sits" class="section level3 unnumbered hasAnchor">
<h3><code>df_sits</code><a href="subgroups2.html#df_sits" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is a <code>data.frame</code> of sightings you want to use to fit the detection function model. For false killer whales in <a href="https://repository.library.noaa.gov/view/noaa/24756">Bradford et al. (2020)</a>, this is a combination of systematic-effort sightings prior to 2011 (made without the PC protocol) and “Phase 1” sightings from 2011 onwards (using the PC protocol). No filtering will be applied to these sightings within this function, so make sure you provide the data pre-filtered. <a href="https://repository.library.noaa.gov/view/noaa/24756">Bradford et al. (2020)</a> used a single detection function for all populations of false killer whales.</p>
<p><code>LTabundR</code> has a built-in dataset for processed Central North Pacific surveys, 1986-2020, using 150-km segments. We will use that here:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="subgroups2.html#cb194-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;cnp_150km_1986_2020&quot;</span>)</span>
<span id="cb194-2"><a href="subgroups2.html#cb194-2" tabindex="-1"></a>cruz <span class="ot">&lt;-</span> cnp_150km_1986_2020</span></code></pre></div>
<p>The code used to generate this dataset can be seen by pulling up the help documentation: <code>?noaa_10km_1986_2020</code>.</p>
<p>All systematic-effort sightings from 1986-2010 are assumed to represent an initial “Phase 1” subgroup sighting (even though the PC protocol was not yet in practice), and therefore usable in detection function estimation. Here we draw those sightings from the above <code>cruz</code> object, filtering as needed (the species code for false killer whales is <code>"033"</code>), and to simplify we will select only a few key columns.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="subgroups2.html#cb195-1" tabindex="-1"></a>sits1  <span class="ot">&lt;-</span></span>
<span id="cb195-2"><a href="subgroups2.html#cb195-2" tabindex="-1"></a>  cruz<span class="sc">$</span>cohorts<span class="sc">$</span>pseudorca<span class="sc">$</span>sightings <span class="sc">%&gt;%</span></span>
<span id="cb195-3"><a href="subgroups2.html#cb195-3" tabindex="-1"></a>  <span class="fu">filter</span>(OnEffort <span class="sc">==</span> <span class="cn">TRUE</span>,</span>
<span id="cb195-4"><a href="subgroups2.html#cb195-4" tabindex="-1"></a>         year <span class="sc">&lt;</span> <span class="dv">2011</span>,</span>
<span id="cb195-5"><a href="subgroups2.html#cb195-5" tabindex="-1"></a>         Lat <span class="sc">&gt;=</span> <span class="dv">5</span>, Lat <span class="sc">&lt;=</span> <span class="dv">40</span>, Lon <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">185</span>, Lon <span class="sc">&lt;=</span> <span class="sc">-</span><span class="dv">120</span>,</span>
<span id="cb195-6"><a href="subgroups2.html#cb195-6" tabindex="-1"></a>         species <span class="sc">==</span> <span class="st">&#39;033&#39;</span>,</span>
<span id="cb195-7"><a href="subgroups2.html#cb195-7" tabindex="-1"></a>         ObsStd <span class="sc">==</span> <span class="cn">TRUE</span>,</span>
<span id="cb195-8"><a href="subgroups2.html#cb195-8" tabindex="-1"></a>         Bearing <span class="sc">&lt;=</span> <span class="dv">90</span>,</span>
<span id="cb195-9"><a href="subgroups2.html#cb195-9" tabindex="-1"></a>         mixed <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb195-10"><a href="subgroups2.html#cb195-10" tabindex="-1"></a>  <span class="fu">select</span>(DateTime, Lat, Lon, Cruise, PerpDistKm)</span>
<span id="cb195-11"><a href="subgroups2.html#cb195-11" tabindex="-1"></a></span>
<span id="cb195-12"><a href="subgroups2.html#cb195-12" tabindex="-1"></a>sits1 <span class="sc">%&gt;%</span> nrow</span>
<span id="cb195-13"><a href="subgroups2.html#cb195-13" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">18</span></span>
<span id="cb195-14"><a href="subgroups2.html#cb195-14" tabindex="-1"></a></span>
<span id="cb195-15"><a href="subgroups2.html#cb195-15" tabindex="-1"></a>sits1 <span class="sc">%&gt;%</span> head</span>
<span id="cb195-16"><a href="subgroups2.html#cb195-16" tabindex="-1"></a>                     DateTime       Lat       Lon Cruise PerpDistKm</span>
<span id="cb195-17"><a href="subgroups2.html#cb195-17" tabindex="-1"></a>SpPerc14  <span class="dv">2009-02-20</span> <span class="dv">16</span><span class="sc">:</span><span class="dv">07</span><span class="sc">:</span><span class="dv">20</span> <span class="fl">21.461833</span> <span class="sc">-</span><span class="fl">157.4507</span>    <span class="dv">901</span> <span class="fl">0.01823864</span></span>
<span id="cb195-18"><a href="subgroups2.html#cb195-18" tabindex="-1"></a>SpPerc16  <span class="dv">1986-11-13</span> <span class="dv">09</span><span class="sc">:</span><span class="dv">43</span><span class="sc">:</span><span class="dv">00</span> <span class="fl">10.466667</span> <span class="sc">-</span><span class="fl">139.2833</span>    <span class="dv">990</span> <span class="fl">1.17493742</span></span>
<span id="cb195-19"><a href="subgroups2.html#cb195-19" tabindex="-1"></a>SpPerc123 <span class="dv">1989-09-10</span> <span class="dv">17</span><span class="sc">:</span><span class="dv">18</span><span class="sc">:</span><span class="dv">00</span>  <span class="fl">7.350000</span> <span class="sc">-</span><span class="fl">129.5333</span>   <span class="dv">1268</span> <span class="fl">0.07751339</span></span>
<span id="cb195-20"><a href="subgroups2.html#cb195-20" tabindex="-1"></a>SpPerc130 <span class="dv">1990-09-09</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">55</span><span class="sc">:</span><span class="dv">00</span>  <span class="fl">7.750000</span> <span class="sc">-</span><span class="fl">128.3333</span>   <span class="dv">1370</span> <span class="fl">0.00000000</span></span>
<span id="cb195-21"><a href="subgroups2.html#cb195-21" tabindex="-1"></a>SpPerc136 <span class="dv">1998-09-03</span> <span class="dv">09</span><span class="sc">:</span><span class="dv">51</span><span class="sc">:</span><span class="dv">53</span> <span class="fl">13.386167</span> <span class="sc">-</span><span class="fl">153.5658</span>   <span class="dv">1611</span> <span class="fl">1.20590444</span></span>
<span id="cb195-22"><a href="subgroups2.html#cb195-22" tabindex="-1"></a>SpPerc137 <span class="dv">1999-08-18</span> <span class="dv">13</span><span class="sc">:</span><span class="dv">54</span><span class="sc">:</span><span class="dv">24</span>  <span class="fl">7.031167</span> <span class="sc">-</span><span class="fl">145.1092</span>   <span class="dv">1614</span> <span class="fl">1.21766870</span></span></code></pre></div>
<p>For 2011 onwards, we will use Phase 1 subgroup detections from the PC protocol, making sure that the column holding detection distances is named <code>PerpDistKm</code>:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="subgroups2.html#cb196-1" tabindex="-1"></a>sits2  <span class="ot">&lt;-</span></span>
<span id="cb196-2"><a href="subgroups2.html#cb196-2" tabindex="-1"></a>  cruz<span class="sc">$</span>cohorts<span class="sc">$</span>pseudorca<span class="sc">$</span>subgroups<span class="sc">$</span>subgroups <span class="sc">%&gt;%</span></span>
<span id="cb196-3"><a href="subgroups2.html#cb196-3" tabindex="-1"></a>  <span class="fu">filter</span>(OnEffort <span class="sc">==</span> <span class="cn">TRUE</span>,</span>
<span id="cb196-4"><a href="subgroups2.html#cb196-4" tabindex="-1"></a>         lubridate<span class="sc">::</span><span class="fu">year</span>(DateTime) <span class="sc">&gt;=</span> <span class="dv">2011</span>,</span>
<span id="cb196-5"><a href="subgroups2.html#cb196-5" tabindex="-1"></a>         Lat <span class="sc">&gt;=</span> <span class="dv">5</span>, Lat <span class="sc">&lt;=</span> <span class="dv">40</span>, Lon <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">185</span>, Lon <span class="sc">&lt;=</span> <span class="sc">-</span><span class="dv">120</span>,</span>
<span id="cb196-6"><a href="subgroups2.html#cb196-6" tabindex="-1"></a>         ObsStd <span class="sc">==</span> <span class="cn">TRUE</span>,</span>
<span id="cb196-7"><a href="subgroups2.html#cb196-7" tabindex="-1"></a>         Angle <span class="sc">&lt;=</span> <span class="dv">90</span>,</span>
<span id="cb196-8"><a href="subgroups2.html#cb196-8" tabindex="-1"></a>         Species <span class="sc">==</span> <span class="st">&#39;033&#39;</span>,</span>
<span id="cb196-9"><a href="subgroups2.html#cb196-9" tabindex="-1"></a>         Phase <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb196-10"><a href="subgroups2.html#cb196-10" tabindex="-1"></a>  <span class="fu">select</span>(DateTime, Lat, Lon, Cruise, <span class="at">PerpDistKm =</span> PerpDist)</span>
<span id="cb196-11"><a href="subgroups2.html#cb196-11" tabindex="-1"></a></span>
<span id="cb196-12"><a href="subgroups2.html#cb196-12" tabindex="-1"></a>sits2 <span class="sc">%&gt;%</span> nrow</span>
<span id="cb196-13"><a href="subgroups2.html#cb196-13" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">65</span></span>
<span id="cb196-14"><a href="subgroups2.html#cb196-14" tabindex="-1"></a></span>
<span id="cb196-15"><a href="subgroups2.html#cb196-15" tabindex="-1"></a>sits2 <span class="sc">%&gt;%</span> head</span>
<span id="cb196-16"><a href="subgroups2.html#cb196-16" tabindex="-1"></a>             DateTime       Lat       Lon Cruise PerpDistKm</span>
<span id="cb196-17"><a href="subgroups2.html#cb196-17" tabindex="-1"></a><span class="dv">1</span> <span class="dv">2011-10-26</span> <span class="dv">13</span><span class="sc">:</span><span class="dv">16</span><span class="sc">:</span><span class="dv">06</span>  <span class="fl">7.240500</span> <span class="sc">-</span><span class="fl">164.9347</span>   <span class="dv">1108</span>  <span class="fl">1.4714466</span></span>
<span id="cb196-18"><a href="subgroups2.html#cb196-18" tabindex="-1"></a><span class="dv">2</span> <span class="dv">2011-10-26</span> <span class="dv">13</span><span class="sc">:</span><span class="dv">31</span><span class="sc">:</span><span class="dv">17</span>  <span class="fl">7.207333</span> <span class="sc">-</span><span class="fl">164.9572</span>   <span class="dv">1108</span>  <span class="fl">2.1211999</span></span>
<span id="cb196-19"><a href="subgroups2.html#cb196-19" tabindex="-1"></a><span class="dv">3</span> <span class="dv">2011-10-26</span> <span class="dv">13</span><span class="sc">:</span><span class="dv">48</span><span class="sc">:</span><span class="dv">26</span>  <span class="fl">7.169667</span> <span class="sc">-</span><span class="fl">164.9830</span>   <span class="dv">1108</span>  <span class="fl">0.9876483</span></span>
<span id="cb196-20"><a href="subgroups2.html#cb196-20" tabindex="-1"></a><span class="dv">4</span> <span class="dv">2011-10-26</span> <span class="dv">14</span><span class="sc">:</span><span class="dv">02</span><span class="sc">:</span><span class="dv">29</span>  <span class="fl">7.139000</span> <span class="sc">-</span><span class="fl">165.0043</span>   <span class="dv">1108</span>  <span class="fl">1.5731017</span></span>
<span id="cb196-21"><a href="subgroups2.html#cb196-21" tabindex="-1"></a><span class="dv">5</span> <span class="dv">2013-05-13</span> <span class="dv">07</span><span class="sc">:</span><span class="dv">09</span><span class="sc">:</span><span class="dv">54</span> <span class="fl">24.302333</span> <span class="sc">-</span><span class="fl">168.3195</span>   <span class="dv">1303</span>  <span class="fl">1.6787670</span></span>
<span id="cb196-22"><a href="subgroups2.html#cb196-22" tabindex="-1"></a><span class="dv">6</span> <span class="dv">2013-05-13</span> <span class="dv">07</span><span class="sc">:</span><span class="dv">24</span><span class="sc">:</span><span class="dv">54</span> <span class="fl">24.343500</span> <span class="sc">-</span><span class="fl">168.3315</span>   <span class="dv">1303</span>  <span class="fl">0.9470481</span></span></code></pre></div>
<p>To create <code>df_sits</code> for detection function fitting, we combine these datasets together:</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="subgroups2.html#cb197-1" tabindex="-1"></a>df_sits <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sits1, sits2)</span>
<span id="cb197-2"><a href="subgroups2.html#cb197-2" tabindex="-1"></a></span>
<span id="cb197-3"><a href="subgroups2.html#cb197-3" tabindex="-1"></a>df_sits <span class="sc">%&gt;%</span> nrow</span>
<span id="cb197-4"><a href="subgroups2.html#cb197-4" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">83</span></span></code></pre></div>
</div>
<div id="truncation_distance" class="section level3 unnumbered hasAnchor">
<h3><code>truncation_distance</code><a href="subgroups2.html#truncation_distance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The truncation distance, in km, will be applied during detection function model fitting. Typically the farthest 5 - 10% of sightings are truncated, but this needs to be balanced by sample size considerations.</p>
<p>Tabulate detection distances using a <code>LTabundR</code> function:</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="subgroups2.html#cb198-1" tabindex="-1"></a>dists <span class="ot">&lt;-</span> </span>
<span id="cb198-2"><a href="subgroups2.html#cb198-2" tabindex="-1"></a>  <span class="fu">summarize_distances</span>(df_sits<span class="sc">$</span>PerpDistKm) <span class="sc">%&gt;%</span> </span>
<span id="cb198-3"><a href="subgroups2.html#cb198-3" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>total_within)</span>
<span id="cb198-4"><a href="subgroups2.html#cb198-4" tabindex="-1"></a></span>
<span id="cb198-5"><a href="subgroups2.html#cb198-5" tabindex="-1"></a>dists</span>
<span id="cb198-6"><a href="subgroups2.html#cb198-6" tabindex="-1"></a>   km_min_incl km_max_excl sightings percent_beyond total_beyond km_mid</span>
<span id="cb198-7"><a href="subgroups2.html#cb198-7" tabindex="-1"></a><span class="dv">1</span>          <span class="fl">0.0</span>         <span class="fl">0.0</span>         <span class="dv">5</span>      <span class="fl">93.975904</span>           <span class="dv">78</span>   <span class="fl">0.00</span></span>
<span id="cb198-8"><a href="subgroups2.html#cb198-8" tabindex="-1"></a><span class="dv">2</span>          <span class="fl">0.0</span>         <span class="fl">0.5</span>        <span class="dv">16</span>      <span class="fl">74.698795</span>           <span class="dv">62</span>   <span class="fl">0.25</span></span>
<span id="cb198-9"><a href="subgroups2.html#cb198-9" tabindex="-1"></a><span class="dv">3</span>          <span class="fl">0.5</span>         <span class="fl">1.0</span>        <span class="dv">11</span>      <span class="fl">61.445783</span>           <span class="dv">51</span>   <span class="fl">0.75</span></span>
<span id="cb198-10"><a href="subgroups2.html#cb198-10" tabindex="-1"></a><span class="dv">4</span>          <span class="fl">1.0</span>         <span class="fl">1.5</span>        <span class="dv">13</span>      <span class="fl">45.783133</span>           <span class="dv">38</span>   <span class="fl">1.25</span></span>
<span id="cb198-11"><a href="subgroups2.html#cb198-11" tabindex="-1"></a><span class="dv">5</span>          <span class="fl">1.5</span>         <span class="fl">2.0</span>         <span class="dv">9</span>      <span class="fl">34.939759</span>           <span class="dv">29</span>   <span class="fl">1.75</span></span>
<span id="cb198-12"><a href="subgroups2.html#cb198-12" tabindex="-1"></a><span class="dv">6</span>          <span class="fl">2.0</span>         <span class="fl">2.5</span>         <span class="dv">4</span>      <span class="fl">30.120482</span>           <span class="dv">25</span>   <span class="fl">2.25</span></span>
<span id="cb198-13"><a href="subgroups2.html#cb198-13" tabindex="-1"></a><span class="dv">7</span>          <span class="fl">2.5</span>         <span class="fl">3.0</span>         <span class="dv">6</span>      <span class="fl">22.891566</span>           <span class="dv">19</span>   <span class="fl">2.75</span></span>
<span id="cb198-14"><a href="subgroups2.html#cb198-14" tabindex="-1"></a><span class="dv">8</span>          <span class="fl">3.0</span>         <span class="fl">3.5</span>         <span class="dv">4</span>      <span class="fl">18.072289</span>           <span class="dv">15</span>   <span class="fl">3.25</span></span>
<span id="cb198-15"><a href="subgroups2.html#cb198-15" tabindex="-1"></a><span class="dv">9</span>          <span class="fl">3.5</span>         <span class="fl">4.0</span>         <span class="dv">2</span>      <span class="fl">15.662651</span>           <span class="dv">13</span>   <span class="fl">3.75</span></span>
<span id="cb198-16"><a href="subgroups2.html#cb198-16" tabindex="-1"></a><span class="dv">10</span>         <span class="fl">4.0</span>         <span class="fl">4.5</span>         <span class="dv">6</span>       <span class="fl">8.433735</span>            <span class="dv">7</span>   <span class="fl">4.25</span></span>
<span id="cb198-17"><a href="subgroups2.html#cb198-17" tabindex="-1"></a><span class="dv">11</span>         <span class="fl">4.5</span>         <span class="fl">5.0</span>         <span class="dv">2</span>       <span class="fl">6.024096</span>            <span class="dv">5</span>   <span class="fl">4.75</span></span>
<span id="cb198-18"><a href="subgroups2.html#cb198-18" tabindex="-1"></a><span class="dv">12</span>         <span class="fl">5.0</span>         <span class="fl">5.5</span>         <span class="dv">1</span>       <span class="fl">4.819277</span>            <span class="dv">4</span>   <span class="fl">5.25</span></span>
<span id="cb198-19"><a href="subgroups2.html#cb198-19" tabindex="-1"></a><span class="dv">13</span>         <span class="fl">5.5</span>         <span class="fl">6.0</span>         <span class="dv">0</span>       <span class="fl">4.819277</span>            <span class="dv">4</span>   <span class="fl">5.75</span></span>
<span id="cb198-20"><a href="subgroups2.html#cb198-20" tabindex="-1"></a><span class="dv">14</span>         <span class="fl">6.0</span>         <span class="fl">6.5</span>         <span class="dv">1</span>       <span class="fl">3.614458</span>            <span class="dv">3</span>   <span class="fl">6.25</span></span>
<span id="cb198-21"><a href="subgroups2.html#cb198-21" tabindex="-1"></a><span class="dv">15</span>         <span class="fl">6.5</span>         <span class="fl">7.0</span>         <span class="dv">1</span>       <span class="fl">2.409639</span>            <span class="dv">2</span>   <span class="fl">6.75</span></span>
<span id="cb198-22"><a href="subgroups2.html#cb198-22" tabindex="-1"></a><span class="dv">16</span>         <span class="fl">7.0</span>         <span class="fl">7.5</span>         <span class="dv">0</span>       <span class="fl">2.409639</span>            <span class="dv">2</span>   <span class="fl">7.25</span></span>
<span id="cb198-23"><a href="subgroups2.html#cb198-23" tabindex="-1"></a><span class="dv">17</span>         <span class="fl">7.5</span>         <span class="fl">8.0</span>         <span class="dv">1</span>       <span class="fl">1.204819</span>            <span class="dv">1</span>   <span class="fl">7.75</span></span>
<span id="cb198-24"><a href="subgroups2.html#cb198-24" tabindex="-1"></a><span class="dv">18</span>         <span class="fl">8.0</span>         <span class="fl">8.5</span>         <span class="dv">1</span>       <span class="fl">0.000000</span>            <span class="dv">0</span>   <span class="fl">8.25</span></span></code></pre></div>
<p>Plot these options:</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="subgroups2.html#cb199-1" tabindex="-1"></a><span class="fu">ggplot</span>(dists, <span class="fu">aes</span>(<span class="at">x=</span>km_max_excl, <span class="at">y=</span>percent_beyond)) <span class="sc">+</span> </span>
<span id="cb199-2"><a href="subgroups2.html#cb199-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_path</span>() <span class="sc">+</span> </span>
<span id="cb199-3"><a href="subgroups2.html#cb199-3" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">10</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">color=</span><span class="st">&#39;firebrick&#39;</span>) <span class="sc">+</span> </span>
<span id="cb199-4"><a href="subgroups2.html#cb199-4" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Percent of sightings beyond this distance&#39;</span>) <span class="sc">+</span></span>
<span id="cb199-5"><a href="subgroups2.html#cb199-5" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Perpendicular distance (km)&#39;</span>) <span class="sc">+</span> </span>
<span id="cb199-6"><a href="subgroups2.html#cb199-6" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">n.breaks =</span> <span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb199-7"><a href="subgroups2.html#cb199-7" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="at">n.breaks =</span> <span class="dv">10</span>) </span></code></pre></div>
<p><img src="figures/unnamed-chunk-270-1.png" width="672" /></p>
<p>Based on these results, we will choose a truncation distance of 4.5 km.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="subgroups2.html#cb200-1" tabindex="-1"></a>truncation_distance <span class="ot">&lt;-</span> <span class="fl">4.5</span></span></code></pre></div>
</div>
<div id="ss" class="section level3 unnumbered hasAnchor">
<h3><code>ss</code><a href="subgroups2.html#ss" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is a numeric vector of subgroup school sizes. The function will find this vector’s arithmetic mean and bootstrapped CV. In <a href="https://repository.library.noaa.gov/view/noaa/24756">Bradford et al. (2020)</a>, school size data come from all Phase 1 and Phase 2 estimates of subgroup sizes from 2011 onwards. In the processed <code>cruz</code> object, each of those estimates is the geometric mean of repeat estimates from separate observers.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="subgroups2.html#cb201-1" tabindex="-1"></a>ss  <span class="ot">&lt;-</span></span>
<span id="cb201-2"><a href="subgroups2.html#cb201-2" tabindex="-1"></a>  cruz<span class="sc">$</span>cohort<span class="sc">$</span>all<span class="sc">$</span>subgroups<span class="sc">$</span>subgroups <span class="sc">%&gt;%</span></span>
<span id="cb201-3"><a href="subgroups2.html#cb201-3" tabindex="-1"></a>  <span class="fu">filter</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(DateTime) <span class="sc">&gt;=</span> <span class="dv">2011</span>,</span>
<span id="cb201-4"><a href="subgroups2.html#cb201-4" tabindex="-1"></a>         Lat <span class="sc">&gt;=</span> <span class="dv">5</span>, Lat <span class="sc">&lt;=</span> <span class="dv">40</span>, Lon <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">185</span>, Lon <span class="sc">&lt;=</span> <span class="sc">-</span><span class="dv">120</span>,</span>
<span id="cb201-5"><a href="subgroups2.html#cb201-5" tabindex="-1"></a>         GSBest_geom_valid <span class="sc">==</span> <span class="cn">TRUE</span>, <span class="co"># only use valid &quot;Best&quot; estimates</span></span>
<span id="cb201-6"><a href="subgroups2.html#cb201-6" tabindex="-1"></a>         Species <span class="sc">==</span> <span class="st">&#39;033&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb201-7"><a href="subgroups2.html#cb201-7" tabindex="-1"></a>  <span class="fu">pull</span>(GSBest_geom)</span>
<span id="cb201-8"><a href="subgroups2.html#cb201-8" tabindex="-1"></a>  </span>
<span id="cb201-9"><a href="subgroups2.html#cb201-9" tabindex="-1"></a>ss <span class="sc">%&gt;%</span> length</span>
<span id="cb201-10"><a href="subgroups2.html#cb201-10" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">180</span></span>
<span id="cb201-11"><a href="subgroups2.html#cb201-11" tabindex="-1"></a></span>
<span id="cb201-12"><a href="subgroups2.html#cb201-12" tabindex="-1"></a>ss</span>
<span id="cb201-13"><a href="subgroups2.html#cb201-13" tabindex="-1"></a>  [<span class="dv">1</span>]  <span class="fl">5.00</span>  <span class="fl">7.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">1.26</span>  <span class="fl">2.00</span>  <span class="fl">2.63</span>  <span class="fl">2.62</span>  <span class="fl">1.00</span>  <span class="fl">5.75</span>  <span class="fl">1.00</span>  <span class="fl">1.73</span></span>
<span id="cb201-14"><a href="subgroups2.html#cb201-14" tabindex="-1"></a> [<span class="dv">13</span>] <span class="fl">17.94</span>  <span class="fl">1.00</span>  <span class="fl">4.00</span>  <span class="fl">4.76</span>  <span class="fl">1.73</span>  <span class="fl">1.00</span>  <span class="fl">3.78</span>  <span class="fl">4.47</span>  <span class="fl">2.45</span>  <span class="fl">2.00</span>  <span class="fl">2.00</span>  <span class="fl">1.00</span></span>
<span id="cb201-15"><a href="subgroups2.html#cb201-15" tabindex="-1"></a> [<span class="dv">25</span>]  <span class="fl">1.00</span>  <span class="fl">5.00</span>  <span class="fl">1.00</span>  <span class="fl">4.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">2.00</span>  <span class="fl">1.00</span></span>
<span id="cb201-16"><a href="subgroups2.html#cb201-16" tabindex="-1"></a> [<span class="dv">37</span>]  <span class="fl">4.00</span>  <span class="fl">7.55</span>  <span class="fl">2.00</span>  <span class="fl">4.12</span>  <span class="fl">7.09</span>  <span class="fl">2.83</span>  <span class="fl">2.00</span>  <span class="fl">3.00</span>  <span class="fl">2.88</span>  <span class="fl">3.46</span>  <span class="fl">4.24</span>  <span class="fl">2.00</span></span>
<span id="cb201-17"><a href="subgroups2.html#cb201-17" tabindex="-1"></a> [<span class="dv">49</span>]  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">2.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">2.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span></span>
<span id="cb201-18"><a href="subgroups2.html#cb201-18" tabindex="-1"></a> [<span class="dv">61</span>]  <span class="fl">1.86</span>  <span class="fl">2.47</span>  <span class="fl">2.00</span>  <span class="fl">1.41</span>  <span class="fl">2.52</span>  <span class="fl">1.26</span>  <span class="fl">2.00</span>  <span class="fl">6.00</span>  <span class="fl">4.16</span>  <span class="fl">2.00</span>  <span class="fl">1.00</span>  <span class="fl">3.00</span></span>
<span id="cb201-19"><a href="subgroups2.html#cb201-19" tabindex="-1"></a> [<span class="dv">73</span>]  <span class="fl">5.00</span>  <span class="fl">5.67</span>  <span class="fl">4.00</span>  <span class="fl">1.00</span>  <span class="fl">2.00</span>  <span class="fl">2.00</span>  <span class="fl">4.00</span>  <span class="fl">4.47</span>  <span class="fl">2.00</span>  <span class="fl">2.00</span>  <span class="fl">2.00</span>  <span class="fl">4.47</span></span>
<span id="cb201-20"><a href="subgroups2.html#cb201-20" tabindex="-1"></a> [<span class="dv">85</span>]  <span class="fl">2.00</span>  <span class="fl">1.00</span>  <span class="fl">2.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">2.00</span>  <span class="fl">2.00</span>  <span class="fl">1.41</span>  <span class="fl">4.47</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">3.17</span></span>
<span id="cb201-21"><a href="subgroups2.html#cb201-21" tabindex="-1"></a> [<span class="dv">97</span>]  <span class="fl">2.88</span>  <span class="fl">2.00</span>  <span class="fl">2.00</span>  <span class="fl">6.00</span>  <span class="fl">5.00</span>  <span class="fl">3.63</span>  <span class="fl">2.00</span>  <span class="fl">3.00</span>  <span class="fl">2.00</span>  <span class="fl">8.12</span>  <span class="fl">8.00</span>  <span class="fl">4.00</span></span>
<span id="cb201-22"><a href="subgroups2.html#cb201-22" tabindex="-1"></a>[<span class="dv">109</span>]  <span class="fl">2.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">4.00</span>  <span class="fl">4.00</span>  <span class="fl">2.00</span>  <span class="fl">1.00</span>  <span class="fl">2.00</span>  <span class="fl">6.00</span>  <span class="fl">2.00</span>  <span class="fl">2.00</span>  <span class="fl">2.38</span></span>
<span id="cb201-23"><a href="subgroups2.html#cb201-23" tabindex="-1"></a>[<span class="dv">121</span>]  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">2.00</span>  <span class="fl">2.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span></span>
<span id="cb201-24"><a href="subgroups2.html#cb201-24" tabindex="-1"></a>[<span class="dv">133</span>]  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">2.00</span>  <span class="fl">1.00</span>  <span class="fl">2.00</span>  <span class="fl">2.00</span>  <span class="fl">1.73</span>  <span class="fl">1.00</span>  <span class="fl">4.00</span>  <span class="fl">7.48</span>  <span class="fl">1.41</span>  <span class="fl">2.00</span></span>
<span id="cb201-25"><a href="subgroups2.html#cb201-25" tabindex="-1"></a>[<span class="dv">145</span>]  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">2.00</span>  <span class="fl">1.00</span>  <span class="fl">2.00</span>  <span class="fl">2.83</span>  <span class="fl">3.00</span>  <span class="fl">2.00</span>  <span class="fl">3.00</span>  <span class="fl">1.41</span></span>
<span id="cb201-26"><a href="subgroups2.html#cb201-26" tabindex="-1"></a>[<span class="dv">157</span>]  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">2.83</span>  <span class="fl">2.00</span>  <span class="fl">4.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">2.00</span>  <span class="fl">2.00</span>  <span class="fl">4.00</span>  <span class="fl">2.00</span></span>
<span id="cb201-27"><a href="subgroups2.html#cb201-27" tabindex="-1"></a>[<span class="dv">169</span>]  <span class="fl">2.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">2.83</span>  <span class="fl">1.00</span>  <span class="fl">2.88</span>  <span class="fl">2.45</span>  <span class="fl">2.00</span>  <span class="fl">2.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span>  <span class="fl">1.00</span></span></code></pre></div>
</div>
<div id="rg0-1" class="section level3 unnumbered hasAnchor">
<h3><code>Rg0</code><a href="subgroups2.html#rg0-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is a <code>data.frame</code> with estimates of Relative <em>g(0)</em> and its CV at each Beaufort sea state. If this input is left <code>NULL</code>, then these estimates will be produced by the function using the subsequent <code>g0_</code> inputs below. If this input is <em>not</em> supplied and any of the subsequent <code>g0_</code> inputs are missing, then <em>g(0)</em> will be assumed to be 1.0 with CV of 0.0.</p>
<p>When you do supply this <code>Rg0</code> input, the <code>data.frame</code> has three required columns: <code>bft</code> (Beaufort sea state, numbers between 0 and 6), <code>Rg0</code> (<em>Rg(0)</em> estimates for each Beaufort state), <code>Rg0_CV</code> (the CV of the <em>Rg(0)</em> estimate in each Beaufort state). Other columns are allowed but will be ignored.</p>
<p>Here is an example of a valid <code>Rg0</code> input based on the values reported for false killer whales in <a href="https://www.fisheries.noaa.gov/inport/item/59592">Bradford et al. (2020)</a>. (These numbers are also available in the built-in dataset <code>barlow_2015</code>.).</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="subgroups2.html#cb202-1" tabindex="-1"></a>Rg0 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">bft =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb202-2"><a href="subgroups2.html#cb202-2" tabindex="-1"></a>                  <span class="at">Rg0 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.72</span>, <span class="fl">0.51</span>, <span class="fl">0.37</span>, <span class="fl">0.26</span>, <span class="fl">0.19</span>),</span>
<span id="cb202-3"><a href="subgroups2.html#cb202-3" tabindex="-1"></a>                  <span class="at">Rg0_CV =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.11</span>, <span class="fl">0.22</span>, <span class="fl">0.34</span>, <span class="fl">0.46</span>, <span class="fl">0.59</span>))</span>
<span id="cb202-4"><a href="subgroups2.html#cb202-4" tabindex="-1"></a></span>
<span id="cb202-5"><a href="subgroups2.html#cb202-5" tabindex="-1"></a>Rg0</span>
<span id="cb202-6"><a href="subgroups2.html#cb202-6" tabindex="-1"></a>  bft  Rg0 Rg0_CV</span>
<span id="cb202-7"><a href="subgroups2.html#cb202-7" tabindex="-1"></a><span class="dv">1</span>   <span class="dv">0</span> <span class="fl">1.00</span>   <span class="fl">0.00</span></span>
<span id="cb202-8"><a href="subgroups2.html#cb202-8" tabindex="-1"></a><span class="dv">2</span>   <span class="dv">1</span> <span class="fl">1.00</span>   <span class="fl">0.00</span></span>
<span id="cb202-9"><a href="subgroups2.html#cb202-9" tabindex="-1"></a><span class="dv">3</span>   <span class="dv">2</span> <span class="fl">0.72</span>   <span class="fl">0.11</span></span>
<span id="cb202-10"><a href="subgroups2.html#cb202-10" tabindex="-1"></a><span class="dv">4</span>   <span class="dv">3</span> <span class="fl">0.51</span>   <span class="fl">0.22</span></span>
<span id="cb202-11"><a href="subgroups2.html#cb202-11" tabindex="-1"></a><span class="dv">5</span>   <span class="dv">4</span> <span class="fl">0.37</span>   <span class="fl">0.34</span></span>
<span id="cb202-12"><a href="subgroups2.html#cb202-12" tabindex="-1"></a><span class="dv">6</span>   <span class="dv">5</span> <span class="fl">0.26</span>   <span class="fl">0.46</span></span>
<span id="cb202-13"><a href="subgroups2.html#cb202-13" tabindex="-1"></a><span class="dv">7</span>   <span class="dv">6</span> <span class="fl">0.19</span>   <span class="fl">0.59</span></span></code></pre></div>
<p>Again: if you supply this input, then the following <code>g0_</code> inputs will be ignored.</p>
</div>
<div id="cruz10" class="section level3 unnumbered hasAnchor">
<h3><code>cruz10</code><a href="subgroups2.html#cruz10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is a processed <code>cruz</code> object with short segment lengths, ideally 10 km or less (hence the 10 in the input name). This <code>cruz</code> object will be used to estimate <em>Rg(0)</em>, i.e., the relative trackline detection probability (see its chapter), using the following <code>g0_</code> inputs. <code>LTabundR</code> comes with a built-in dataset we can use for this purpose:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="subgroups2.html#cb203-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;noaa_10km_1986_2020&quot;</span>)</span>
<span id="cb203-2"><a href="subgroups2.html#cb203-2" tabindex="-1"></a>cruz10 <span class="ot">&lt;-</span> noaa_10km_1986_2020</span></code></pre></div>
<p>The code used to generate this dataset can be seen by pulling up the help documentation: <code>?noaa_10km_1986_2020</code>.</p>
</div>
<div id="g0_spp" class="section level3 unnumbered hasAnchor">
<h3><code>g0_spp</code><a href="subgroups2.html#g0_spp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This and the following <code>g0_</code> inputs will be used to model Relative <em>g(0)</em> estimates and their CV in various Beaufort sea states. If the previous input, <code>Rg0</code> is provided, then these <code>g0_</code> inputs will be ignored, and no <em>Rg(0)</em> modeling will take place. Furthermore, if any of these <code>g0_</code> inputs are not provided, <em>Rg(0)</em> will be coerced to 1.0 with a CV of 0.0 for all sea states.</p>
<p>This input, <code>g0_spp</code>, is a character vector of species code(s) to use to estimate <em>Rg(0)</em>. In most cases this will be a single species, e.g., <code>"033"</code> for false killer whales.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="subgroups2.html#cb204-1" tabindex="-1"></a>g0_spp <span class="ot">&lt;-</span> <span class="st">&#39;033&#39;</span></span></code></pre></div>
</div>
<div id="g0_truncation" class="section level3 unnumbered hasAnchor">
<h3><code>g0_truncation</code><a href="subgroups2.html#g0_truncation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The truncation distance to use when estimating <em>Rg(0)</em>. In <a href="https://repository.library.noaa.gov/view/noaa/24756">Bradford et al. (2020)</a> this is 5.5 km.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="subgroups2.html#cb205-1" tabindex="-1"></a>g0_truncation <span class="ot">&lt;-</span> <span class="fl">5.5</span></span></code></pre></div>
</div>
<div id="g0_constrain_shape" class="section level3 unnumbered hasAnchor">
<h3><code>g0_constrain_shape</code><a href="subgroups2.html#g0_constrain_shape" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Some <em>Rg(0)</em> curves will not decline monotonically due to sample size issues at low Bft (0-2) or high Bft (5-6) states. To coerce monotonic decline, set this input to <code>TRUE</code>, and the function will use a shape-constrained GAM (<code>scam()</code> from package <code>scam</code>) instead of a classic <code>mgcv::gam()</code>.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="subgroups2.html#cb206-1" tabindex="-1"></a>g0_constrain_shape <span class="ot">=</span> <span class="cn">FALSE</span></span></code></pre></div>
</div>
<div id="g0_jackknife_fraction" class="section level3 unnumbered hasAnchor">
<h3><code>g0_jackknife_fraction</code><a href="subgroups2.html#g0_jackknife_fraction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The proportion of data to leave out within each jackknife permutation. The default is <code>0.1</code> (i.e., 10% of the data, yielding 10 jackknife loops), after <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/mms.12205">Barlow (2015)</a>.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="subgroups2.html#cb207-1" tabindex="-1"></a>g0_jackknife_fraction <span class="ot">=</span> <span class="fl">0.1</span></span></code></pre></div>
</div>
<div id="density_segments" class="section level3 unnumbered hasAnchor">
<h3><code>density_segments</code><a href="subgroups2.html#density_segments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The survey segments to be used in density/abundance estimation. For example, <a href="https://repository.library.noaa.gov/view/noaa/24756">Bradford et al. (2020)</a> used 150-km segments to estimate false killer whale density in the Hawaiian EEZ in 2017. For this we can use the 1986-2020 dataset we loaded above. Note that no filtering will be applied to these segments by the <code>lta_subgroup()</code> function, so we need to filter them ourselves first: we want only systematic segments for the Hawaiian EEZ in 2017 (specifically, just cruises 1705 and 1706).</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="subgroups2.html#cb208-1" tabindex="-1"></a>cruzi <span class="ot">&lt;-</span> <span class="fu">filter_cruz</span>(<span class="at">cruz =</span> cruz,</span>
<span id="cb208-2"><a href="subgroups2.html#cb208-2" tabindex="-1"></a>                      <span class="at">analysis_only =</span> <span class="cn">TRUE</span>,</span>
<span id="cb208-3"><a href="subgroups2.html#cb208-3" tabindex="-1"></a>                      <span class="at">years =</span> <span class="dv">2017</span>,</span>
<span id="cb208-4"><a href="subgroups2.html#cb208-4" tabindex="-1"></a>                      <span class="at">cruises =</span> <span class="fu">c</span>(<span class="dv">1705</span>, <span class="dv">1706</span>),</span>
<span id="cb208-5"><a href="subgroups2.html#cb208-5" tabindex="-1"></a>                      <span class="at">regions =</span> <span class="st">&#39;HI_EEZ&#39;</span>,</span>
<span id="cb208-6"><a href="subgroups2.html#cb208-6" tabindex="-1"></a>                      <span class="at">bft_range =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb208-7"><a href="subgroups2.html#cb208-7" tabindex="-1"></a>                      <span class="at">eff_types =</span> <span class="st">&#39;S&#39;</span>,</span>
<span id="cb208-8"><a href="subgroups2.html#cb208-8" tabindex="-1"></a>                      <span class="at">on_off =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>From this filtered cruz object, we will isolate the segments data:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="subgroups2.html#cb209-1" tabindex="-1"></a>density_segments <span class="ot">&lt;-</span> cruzi<span class="sc">$</span>cohorts<span class="sc">$</span>all<span class="sc">$</span>segments</span></code></pre></div>
<p>Since we do not want to stratify our analysis by smaller geostrata, such as the Main Hawaiian Islands, we will go ahead and coerce all stratum assignments to the Hawaiian EEZ geostratum:</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="subgroups2.html#cb210-1" tabindex="-1"></a>density_segments<span class="sc">$</span>stratum <span class="ot">&lt;-</span> <span class="st">&#39;HI_EEZ&#39;</span></span></code></pre></div>
</div>
<div id="density_das" class="section level3 unnumbered hasAnchor">
<h3><code>density_das</code><a href="subgroups2.html#density_das" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is the complete survey data corresponding to the above segments. These data will be used to determine the proportion of survey effort occurring in each Beaufort sea state that is needed to compute weighted estimates of <em>g(0)</em> from the <em>Rg(0)</em> values.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="subgroups2.html#cb211-1" tabindex="-1"></a>density_das <span class="ot">&lt;-</span> cruzi<span class="sc">$</span>cohorts<span class="sc">$</span>all<span class="sc">$</span>das</span></code></pre></div>
</div>
<div id="density_sightings" class="section level3 unnumbered hasAnchor">
<h3><code>density_sightings</code><a href="subgroups2.html#density_sightings" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>These are the encounters to use in density/abundance estimation. In <a href="https://repository.library.noaa.gov/view/noaa/24756">Bradford et al. (2020)</a>, these were the Phase 1 detections of false killer whale subgroups within the population-region-year of interest, e.g., Northwestern Hawaiian Island population sightings within the Hawaiian EEZ in 2017. No filtering is applied to these sightings within <code>lta_subgroups()</code>, so make sure only the sightings you wish to use are included and nothing more.</p>
<p>In this example, since we do not have population information on hand, we will not filter detections to a specific population. Instead, we will estimate abundance of all false killer whales within the Hawaiian EEZ:</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="subgroups2.html#cb212-1" tabindex="-1"></a>density_sightings  <span class="ot">&lt;-</span></span>
<span id="cb212-2"><a href="subgroups2.html#cb212-2" tabindex="-1"></a>  cruz<span class="sc">$</span>cohorts<span class="sc">$</span>all<span class="sc">$</span>subgroups<span class="sc">$</span>subgroups <span class="sc">%&gt;%</span></span>
<span id="cb212-3"><a href="subgroups2.html#cb212-3" tabindex="-1"></a>  <span class="fu">filter</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(DateTime) <span class="sc">==</span> <span class="dv">2017</span>,</span>
<span id="cb212-4"><a href="subgroups2.html#cb212-4" tabindex="-1"></a>         EffType <span class="sc">==</span> <span class="st">&#39;S&#39;</span>,</span>
<span id="cb212-5"><a href="subgroups2.html#cb212-5" tabindex="-1"></a>         OnEffort <span class="sc">==</span> <span class="cn">TRUE</span>,</span>
<span id="cb212-6"><a href="subgroups2.html#cb212-6" tabindex="-1"></a>         PerpDist <span class="sc">&lt;=</span> truncation_distance,</span>
<span id="cb212-7"><a href="subgroups2.html#cb212-7" tabindex="-1"></a>         Angle <span class="sc">&lt;=</span> <span class="dv">90</span>,</span>
<span id="cb212-8"><a href="subgroups2.html#cb212-8" tabindex="-1"></a>         ObsStd <span class="sc">==</span> <span class="cn">TRUE</span>,</span>
<span id="cb212-9"><a href="subgroups2.html#cb212-9" tabindex="-1"></a>         Species <span class="sc">==</span> <span class="st">&#39;033&#39;</span>,</span>
<span id="cb212-10"><a href="subgroups2.html#cb212-10" tabindex="-1"></a>         Phase <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb212-11"><a href="subgroups2.html#cb212-11" tabindex="-1"></a></span>
<span id="cb212-12"><a href="subgroups2.html#cb212-12" tabindex="-1"></a>density_sightings <span class="sc">%&gt;%</span> nrow</span>
<span id="cb212-13"><a href="subgroups2.html#cb212-13" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">23</span></span>
<span id="cb212-14"><a href="subgroups2.html#cb212-14" tabindex="-1"></a></span>
<span id="cb212-15"><a href="subgroups2.html#cb212-15" tabindex="-1"></a>density_sightings <span class="sc">%&gt;%</span> head</span>
<span id="cb212-16"><a href="subgroups2.html#cb212-16" tabindex="-1"></a>  Cruise       Date            DateTime      Lat       Lon OnEffort EffType Bft</span>
<span id="cb212-17"><a href="subgroups2.html#cb212-17" tabindex="-1"></a><span class="dv">1</span>   <span class="dv">1705</span> <span class="dv">2017-09-21</span> <span class="dv">2017-09-21</span> <span class="dv">14</span><span class="sc">:</span><span class="dv">17</span><span class="sc">:</span><span class="dv">27</span> <span class="fl">20.04283</span> <span class="sc">-</span><span class="fl">161.9177</span>     <span class="cn">TRUE</span>       S   <span class="dv">5</span></span>
<span id="cb212-18"><a href="subgroups2.html#cb212-18" tabindex="-1"></a><span class="dv">2</span>   <span class="dv">1705</span> <span class="dv">2017-09-21</span> <span class="dv">2017-09-21</span> <span class="dv">14</span><span class="sc">:</span><span class="dv">39</span><span class="sc">:</span><span class="dv">40</span> <span class="fl">20.06017</span> <span class="sc">-</span><span class="fl">161.9840</span>     <span class="cn">TRUE</span>       S   <span class="dv">5</span></span>
<span id="cb212-19"><a href="subgroups2.html#cb212-19" tabindex="-1"></a><span class="dv">3</span>   <span class="dv">1705</span> <span class="dv">2017-09-29</span> <span class="dv">2017-09-29</span> <span class="dv">13</span><span class="sc">:</span><span class="dv">22</span><span class="sc">:</span><span class="dv">08</span> <span class="fl">23.55750</span> <span class="sc">-</span><span class="fl">175.8527</span>     <span class="cn">TRUE</span>       S   <span class="dv">1</span></span>
<span id="cb212-20"><a href="subgroups2.html#cb212-20" tabindex="-1"></a><span class="dv">4</span>   <span class="dv">1705</span> <span class="dv">2017-09-29</span> <span class="dv">2017-09-29</span> <span class="dv">13</span><span class="sc">:</span><span class="dv">26</span><span class="sc">:</span><span class="dv">05</span> <span class="fl">23.56050</span> <span class="sc">-</span><span class="fl">175.8643</span>     <span class="cn">TRUE</span>       S   <span class="dv">1</span></span>
<span id="cb212-21"><a href="subgroups2.html#cb212-21" tabindex="-1"></a><span class="dv">5</span>   <span class="dv">1705</span> <span class="dv">2017-09-29</span> <span class="dv">2017-09-29</span> <span class="dv">13</span><span class="sc">:</span><span class="dv">32</span><span class="sc">:</span><span class="dv">33</span> <span class="fl">23.56517</span> <span class="sc">-</span><span class="fl">175.8832</span>     <span class="cn">TRUE</span>       S   <span class="dv">1</span></span>
<span id="cb212-22"><a href="subgroups2.html#cb212-22" tabindex="-1"></a><span class="dv">6</span>   <span class="dv">1705</span> <span class="dv">2017-09-29</span> <span class="dv">2017-09-29</span> <span class="dv">13</span><span class="sc">:</span><span class="dv">34</span><span class="sc">:</span><span class="dv">09</span> <span class="fl">23.56633</span> <span class="sc">-</span><span class="fl">175.8878</span>     <span class="cn">TRUE</span>       S   <span class="dv">1</span></span>
<span id="cb212-23"><a href="subgroups2.html#cb212-23" tabindex="-1"></a>  SwellHght RainFog HorizSun VertSun Glare Vis ObsL Rec ObsR ObsInd SightNo</span>
<span id="cb212-24"><a href="subgroups2.html#cb212-24" tabindex="-1"></a><span class="dv">1</span>         <span class="dv">5</span>       <span class="dv">5</span>       <span class="dv">10</span>       <span class="dv">1</span> <span class="cn">FALSE</span> <span class="fl">5.5</span>  <span class="dv">126</span> <span class="dv">384</span>  <span class="dv">399</span>   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>     <span class="dv">064</span></span>
<span id="cb212-25"><a href="subgroups2.html#cb212-25" tabindex="-1"></a><span class="dv">2</span>         <span class="dv">5</span>       <span class="dv">5</span>       <span class="dv">10</span>       <span class="dv">1</span> <span class="cn">FALSE</span> <span class="fl">5.5</span>  <span class="dv">126</span> <span class="dv">384</span>  <span class="dv">399</span>   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>     <span class="dv">064</span></span>
<span id="cb212-26"><a href="subgroups2.html#cb212-26" tabindex="-1"></a><span class="dv">3</span>         <span class="dv">3</span>       <span class="dv">1</span>        <span class="dv">8</span>       <span class="dv">1</span> <span class="cn">FALSE</span> <span class="fl">6.5</span>  <span class="dv">126</span> <span class="dv">384</span>  <span class="dv">399</span>   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>     <span class="dv">073</span></span>
<span id="cb212-27"><a href="subgroups2.html#cb212-27" tabindex="-1"></a><span class="dv">4</span>         <span class="dv">3</span>       <span class="dv">1</span>        <span class="dv">8</span>       <span class="dv">1</span> <span class="cn">FALSE</span> <span class="fl">6.5</span>  <span class="dv">126</span> <span class="dv">384</span>  <span class="dv">399</span>   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>     <span class="dv">073</span></span>
<span id="cb212-28"><a href="subgroups2.html#cb212-28" tabindex="-1"></a><span class="dv">5</span>         <span class="dv">3</span>       <span class="dv">1</span>        <span class="dv">8</span>       <span class="dv">1</span> <span class="cn">FALSE</span> <span class="fl">6.5</span>  <span class="dv">126</span> <span class="dv">384</span>  <span class="dv">399</span>   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>     <span class="dv">073</span></span>
<span id="cb212-29"><a href="subgroups2.html#cb212-29" tabindex="-1"></a><span class="dv">6</span>         <span class="dv">3</span>       <span class="dv">1</span>        <span class="dv">8</span>       <span class="dv">1</span> <span class="cn">FALSE</span> <span class="fl">6.5</span>  <span class="dv">126</span> <span class="dv">384</span>  <span class="dv">399</span>   <span class="sc">&lt;</span><span class="cn">NA</span><span class="sc">&gt;</span>     <span class="dv">073</span></span>
<span id="cb212-30"><a href="subgroups2.html#cb212-30" tabindex="-1"></a>  Obs_Sight Species SubGrp Angle   RadDist seg_id  PerpDist GSBest GSH  GSL</span>
<span id="cb212-31"><a href="subgroups2.html#cb212-31" tabindex="-1"></a><span class="dv">1</span>       <span class="dv">399</span>     <span class="dv">033</span>      A    <span class="dv">14</span> <span class="fl">5.0374102</span>    <span class="dv">491</span> <span class="fl">1.2186598</span>   <span class="fl">3.00</span>   <span class="dv">4</span> <span class="fl">2.00</span></span>
<span id="cb212-32"><a href="subgroups2.html#cb212-32" tabindex="-1"></a><span class="dv">2</span>       <span class="dv">399</span>     <span class="dv">033</span>      B    <span class="dv">24</span> <span class="fl">3.1483814</span>    <span class="dv">491</span> <span class="fl">1.2805621</span>   <span class="fl">3.67</span>   <span class="dv">6</span> <span class="fl">2.33</span></span>
<span id="cb212-33"><a href="subgroups2.html#cb212-33" tabindex="-1"></a><span class="dv">3</span>       <span class="dv">126</span>     <span class="dv">033</span>      A    <span class="dv">49</span> <span class="fl">3.3706200</span>    <span class="dv">502</span> <span class="fl">2.5438392</span>   <span class="fl">2.00</span>   <span class="dv">3</span> <span class="fl">1.00</span></span>
<span id="cb212-34"><a href="subgroups2.html#cb212-34" tabindex="-1"></a><span class="dv">4</span>       <span class="dv">126</span>     <span class="dv">033</span>      B    <span class="dv">68</span> <span class="fl">0.6852359</span>    <span class="dv">502</span> <span class="fl">0.6353397</span>   <span class="fl">1.00</span>   <span class="dv">2</span> <span class="fl">1.00</span></span>
<span id="cb212-35"><a href="subgroups2.html#cb212-35" tabindex="-1"></a><span class="dv">5</span>       <span class="dv">126</span>     <span class="dv">033</span>      E    <span class="dv">89</span> <span class="fl">2.9817023</span>    <span class="dv">502</span> <span class="fl">2.9812482</span>   <span class="fl">1.00</span>   <span class="dv">2</span> <span class="fl">1.00</span></span>
<span id="cb212-36"><a href="subgroups2.html#cb212-36" tabindex="-1"></a><span class="dv">6</span>       <span class="dv">126</span>     <span class="dv">033</span>      F    <span class="dv">12</span> <span class="fl">6.9449589</span>    <span class="dv">502</span> <span class="fl">1.4439381</span>   <span class="fl">1.00</span>   <span class="dv">1</span> <span class="fl">1.00</span></span>
<span id="cb212-37"><a href="subgroups2.html#cb212-37" tabindex="-1"></a>  GSBest_geom GSH_geom GSL_geom GSBest_valid GSBest_geom_valid ObsStd</span>
<span id="cb212-38"><a href="subgroups2.html#cb212-38" tabindex="-1"></a><span class="dv">1</span>        <span class="fl">3.00</span>     <span class="fl">4.00</span>        <span class="dv">2</span>         <span class="cn">TRUE</span>              <span class="cn">TRUE</span>   <span class="cn">TRUE</span></span>
<span id="cb212-39"><a href="subgroups2.html#cb212-39" tabindex="-1"></a><span class="dv">2</span>        <span class="fl">2.88</span>     <span class="fl">4.12</span>        <span class="dv">2</span>         <span class="cn">TRUE</span>              <span class="cn">TRUE</span>   <span class="cn">TRUE</span></span>
<span id="cb212-40"><a href="subgroups2.html#cb212-40" tabindex="-1"></a><span class="dv">3</span>        <span class="fl">2.00</span>     <span class="fl">3.00</span>        <span class="dv">1</span>         <span class="cn">TRUE</span>              <span class="cn">TRUE</span>   <span class="cn">TRUE</span></span>
<span id="cb212-41"><a href="subgroups2.html#cb212-41" tabindex="-1"></a><span class="dv">4</span>        <span class="fl">1.00</span>     <span class="fl">2.00</span>        <span class="dv">1</span>         <span class="cn">TRUE</span>              <span class="cn">TRUE</span>   <span class="cn">TRUE</span></span>
<span id="cb212-42"><a href="subgroups2.html#cb212-42" tabindex="-1"></a><span class="dv">5</span>        <span class="fl">1.00</span>     <span class="fl">2.00</span>        <span class="dv">1</span>         <span class="cn">TRUE</span>              <span class="cn">TRUE</span>   <span class="cn">TRUE</span></span>
<span id="cb212-43"><a href="subgroups2.html#cb212-43" tabindex="-1"></a><span class="dv">6</span>        <span class="fl">1.00</span>     <span class="fl">1.00</span>        <span class="dv">1</span>         <span class="cn">TRUE</span>              <span class="cn">TRUE</span>   <span class="cn">TRUE</span></span>
<span id="cb212-44"><a href="subgroups2.html#cb212-44" tabindex="-1"></a>  stratum_HI_EEZ stratum_OtherCNP stratum_MHI stratum Phase</span>
<span id="cb212-45"><a href="subgroups2.html#cb212-45" tabindex="-1"></a><span class="dv">1</span>           <span class="cn">TRUE</span>             <span class="cn">TRUE</span>       <span class="cn">FALSE</span>  HI_EEZ     <span class="dv">1</span></span>
<span id="cb212-46"><a href="subgroups2.html#cb212-46" tabindex="-1"></a><span class="dv">2</span>           <span class="cn">TRUE</span>             <span class="cn">TRUE</span>       <span class="cn">FALSE</span>  HI_EEZ     <span class="dv">1</span></span>
<span id="cb212-47"><a href="subgroups2.html#cb212-47" tabindex="-1"></a><span class="dv">3</span>           <span class="cn">TRUE</span>             <span class="cn">TRUE</span>       <span class="cn">FALSE</span>  HI_EEZ     <span class="dv">1</span></span>
<span id="cb212-48"><a href="subgroups2.html#cb212-48" tabindex="-1"></a><span class="dv">4</span>           <span class="cn">TRUE</span>             <span class="cn">TRUE</span>       <span class="cn">FALSE</span>  HI_EEZ     <span class="dv">1</span></span>
<span id="cb212-49"><a href="subgroups2.html#cb212-49" tabindex="-1"></a><span class="dv">5</span>           <span class="cn">TRUE</span>             <span class="cn">TRUE</span>       <span class="cn">FALSE</span>  HI_EEZ     <span class="dv">1</span></span>
<span id="cb212-50"><a href="subgroups2.html#cb212-50" tabindex="-1"></a><span class="dv">6</span>           <span class="cn">TRUE</span>             <span class="cn">TRUE</span>       <span class="cn">FALSE</span>  HI_EEZ     <span class="dv">1</span></span></code></pre></div>
<p>As above, let’s make sure the geostratum assignments for these sightings are simple:</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="subgroups2.html#cb213-1" tabindex="-1"></a>density_sightings<span class="sc">$</span>stratum <span class="ot">&lt;-</span> <span class="st">&#39;HI_EEZ&#39;</span></span></code></pre></div>
</div>
<div id="abundance_area" class="section level3 unnumbered hasAnchor">
<h3><code>abundance_area</code><a href="subgroups2.html#abundance_area" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is the area, in square km, of the region of interest. The density estimate will be scaled by this area.</p>
<p>We have two options for finding this area. The first is to draw the area from our <code>cohort$strata</code> slot:</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="subgroups2.html#cb214-1" tabindex="-1"></a>cruz<span class="sc">$</span>strata<span class="sc">$</span>area[cruz<span class="sc">$</span>strata<span class="sc">$</span>stratum <span class="sc">==</span> <span class="st">&#39;HI_EEZ&#39;</span>]</span>
<span id="cb214-2"><a href="subgroups2.html#cb214-2" tabindex="-1"></a><span class="dv">2474596</span> [km<span class="sc">^</span><span class="dv">2</span>]</span></code></pre></div>
<p>The second is to calculate it ourselves using the <code>LTabundR</code> function <code>strata_area()</code>. This second option will be useful if your study area is a complicated combination/substraction of multiple geostrata.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="subgroups2.html#cb215-1" tabindex="-1"></a><span class="fu">data</span>(strata_cnp)</span>
<span id="cb215-2"><a href="subgroups2.html#cb215-2" tabindex="-1"></a></span>
<span id="cb215-3"><a href="subgroups2.html#cb215-3" tabindex="-1"></a>abundance_area <span class="ot">&lt;-</span> </span>
<span id="cb215-4"><a href="subgroups2.html#cb215-4" tabindex="-1"></a>  <span class="fu">strata_area</span>(<span class="at">strata_all =</span> strata_cnp,</span>
<span id="cb215-5"><a href="subgroups2.html#cb215-5" tabindex="-1"></a>              <span class="at">strata_keep =</span> <span class="st">&#39;HI_EEZ&#39;</span>)<span class="sc">$</span>km2</span></code></pre></div>
<p><img src="figures/unnamed-chunk-286-1.png" width="672" /></p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="subgroups2.html#cb216-1" tabindex="-1"></a></span>
<span id="cb216-2"><a href="subgroups2.html#cb216-2" tabindex="-1"></a>abundance_area</span>
<span id="cb216-3"><a href="subgroups2.html#cb216-3" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">2474596</span></span></code></pre></div>
</div>
<div id="remaining-inputs" class="section level3 unnumbered hasAnchor">
<h3>Remaining inputs<a href="subgroups2.html#remaining-inputs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong><code>iterations</code></strong>: Number of iterations to use in the various CV bootstrapping procedures occurring throughout this function, specifically: effective strip width CV estimation, subgroup size CV estimation, weighted <em>g(0)</em> CV estimation, and encounter rate estimation.</p>
<p><strong><code>output_dir</code></strong>: The path in which results RData files should be stored. If left ““, the current working directory will be used.</p>
<p><strong><code>toplot</code></strong>: A Boolean, with default FALSE, indicating whether to plot various aspects of the analysis.</p>
<p><strong><code>verbose</code></strong>: A Boolean, with default TRUE, indicating whether to print status updates to the Console.</p>
<p><strong><code>density_bootstraps</code></strong>: Number of bootstrap iterations to use for the CV estimate of density and abundance specifically. This input allows this final step to use a different (typically larger) iteration size than the iterations input above.</p>
<p>Here we call the <code>lta_subgroup()</code> function without re-modeling the Relative <em>g(0)</em> parameters, with only 200 iterations:</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="subgroups2.html#cb217-1" tabindex="-1"></a>results_subgroup <span class="ot">&lt;-</span> </span>
<span id="cb217-2"><a href="subgroups2.html#cb217-2" tabindex="-1"></a>  <span class="fu">lta_subgroup</span>(<span class="at">df_sits =</span> df_sits,</span>
<span id="cb217-3"><a href="subgroups2.html#cb217-3" tabindex="-1"></a>               <span class="at">truncation_distance =</span> truncation_distance,</span>
<span id="cb217-4"><a href="subgroups2.html#cb217-4" tabindex="-1"></a>               <span class="at">ss =</span> ss,</span>
<span id="cb217-5"><a href="subgroups2.html#cb217-5" tabindex="-1"></a>               <span class="at">density_segments =</span> density_segments,</span>
<span id="cb217-6"><a href="subgroups2.html#cb217-6" tabindex="-1"></a>               <span class="at">density_das =</span> density_das,</span>
<span id="cb217-7"><a href="subgroups2.html#cb217-7" tabindex="-1"></a>               <span class="at">density_sightings =</span> density_sightings,</span>
<span id="cb217-8"><a href="subgroups2.html#cb217-8" tabindex="-1"></a>               <span class="at">Rg0 =</span> Rg0,</span>
<span id="cb217-9"><a href="subgroups2.html#cb217-9" tabindex="-1"></a>               <span class="at">abundance_area =</span> abundance_area,</span>
<span id="cb217-10"><a href="subgroups2.html#cb217-10" tabindex="-1"></a>               <span class="at">iterations =</span> <span class="dv">200</span>,</span>
<span id="cb217-11"><a href="subgroups2.html#cb217-11" tabindex="-1"></a>               <span class="at">output_dir =</span> <span class="st">&#39;subgroup/&#39;</span>,</span>
<span id="cb217-12"><a href="subgroups2.html#cb217-12" tabindex="-1"></a>               <span class="at">toplot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb217-13"><a href="subgroups2.html#cb217-13" tabindex="-1"></a>               <span class="at">verbose =</span> <span class="cn">TRUE</span>,</span>
<span id="cb217-14"><a href="subgroups2.html#cb217-14" tabindex="-1"></a>               <span class="at">density_bootstraps =</span> <span class="dv">10000</span>)</span></code></pre></div>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="subgroups2.html#cb218-1" tabindex="-1"></a><span class="fu">save</span>(results_subgroup, <span class="at">file=</span><span class="st">&#39;results_subgroup.RData&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="subgroups2.html#cb219-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&#39;results_subgroup.RData&#39;</span>)</span></code></pre></div>
</div>
</div>
<div id="outputs-1" class="section level2 unnumbered hasAnchor">
<h2>Outputs<a href="subgroups2.html#outputs-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The function returns a <code>list</code> with many slots, including estimates of density and abundance – along with estimates of intermediate parameters – with a CV derived from a bootstrapping routine. To demonstrate this output, we will use results from a call with only 10 bootstrap iterations.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="subgroups2.html#cb220-1" tabindex="-1"></a>results_subgroup <span class="sc">%&gt;%</span> names</span>
<span id="cb220-2"><a href="subgroups2.html#cb220-2" tabindex="-1"></a> [<span class="dv">1</span>] <span class="st">&quot;D&quot;</span>                  <span class="st">&quot;D_CV&quot;</span>               <span class="st">&quot;D_L95&quot;</span>             </span>
<span id="cb220-3"><a href="subgroups2.html#cb220-3" tabindex="-1"></a> [<span class="dv">4</span>] <span class="st">&quot;D_U95&quot;</span>              <span class="st">&quot;N&quot;</span>                  <span class="st">&quot;N_CV&quot;</span>              </span>
<span id="cb220-4"><a href="subgroups2.html#cb220-4" tabindex="-1"></a> [<span class="dv">7</span>] <span class="st">&quot;N_L95&quot;</span>              <span class="st">&quot;N_U95&quot;</span>              <span class="st">&quot;ER&quot;</span>                </span>
<span id="cb220-5"><a href="subgroups2.html#cb220-5" tabindex="-1"></a>[<span class="dv">10</span>] <span class="st">&quot;ESW&quot;</span>                <span class="st">&quot;ESW_CV&quot;</span>             <span class="st">&quot;ss&quot;</span>                </span>
<span id="cb220-6"><a href="subgroups2.html#cb220-6" tabindex="-1"></a>[<span class="dv">13</span>] <span class="st">&quot;n&quot;</span>                  <span class="st">&quot;L&quot;</span>                  <span class="st">&quot;n_segments&quot;</span>        </span>
<span id="cb220-7"><a href="subgroups2.html#cb220-7" tabindex="-1"></a>[<span class="dv">16</span>] <span class="st">&quot;g0&quot;</span>                 <span class="st">&quot;g0_cv&quot;</span>              <span class="st">&quot;g0_details&quot;</span>        </span>
<span id="cb220-8"><a href="subgroups2.html#cb220-8" tabindex="-1"></a>[<span class="dv">19</span>] <span class="st">&quot;df&quot;</span>                 <span class="st">&quot;bootstraps&quot;</span>         <span class="st">&quot;iterations&quot;</span>        </span>
<span id="cb220-9"><a href="subgroups2.html#cb220-9" tabindex="-1"></a>[<span class="dv">22</span>] <span class="st">&quot;density_bootstraps&quot;</span></span></code></pre></div>
<p>Most of these slots hold best-estimates of parameters or sample size details:</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="subgroups2.html#cb221-1" tabindex="-1"></a>results_subgroup[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">17</span>, <span class="dv">21</span><span class="sc">:</span><span class="dv">22</span>)]</span>
<span id="cb221-2"><a href="subgroups2.html#cb221-2" tabindex="-1"></a><span class="sc">$</span>D</span>
<span id="cb221-3"><a href="subgroups2.html#cb221-3" tabindex="-1"></a>          <span class="dv">1</span> </span>
<span id="cb221-4"><a href="subgroups2.html#cb221-4" tabindex="-1"></a><span class="fl">0.002180381</span> </span>
<span id="cb221-5"><a href="subgroups2.html#cb221-5" tabindex="-1"></a></span>
<span id="cb221-6"><a href="subgroups2.html#cb221-6" tabindex="-1"></a><span class="sc">$</span>D_CV</span>
<span id="cb221-7"><a href="subgroups2.html#cb221-7" tabindex="-1"></a>        <span class="dv">1</span> </span>
<span id="cb221-8"><a href="subgroups2.html#cb221-8" tabindex="-1"></a><span class="fl">0.4861588</span> </span>
<span id="cb221-9"><a href="subgroups2.html#cb221-9" tabindex="-1"></a></span>
<span id="cb221-10"><a href="subgroups2.html#cb221-10" tabindex="-1"></a><span class="sc">$</span>D_L95</span>
<span id="cb221-11"><a href="subgroups2.html#cb221-11" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.0005565786</span></span>
<span id="cb221-12"><a href="subgroups2.html#cb221-12" tabindex="-1"></a></span>
<span id="cb221-13"><a href="subgroups2.html#cb221-13" tabindex="-1"></a><span class="sc">$</span>D_U95</span>
<span id="cb221-14"><a href="subgroups2.html#cb221-14" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.005437708</span></span>
<span id="cb221-15"><a href="subgroups2.html#cb221-15" tabindex="-1"></a></span>
<span id="cb221-16"><a href="subgroups2.html#cb221-16" tabindex="-1"></a><span class="sc">$</span>N</span>
<span id="cb221-17"><a href="subgroups2.html#cb221-17" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">5396</span></span>
<span id="cb221-18"><a href="subgroups2.html#cb221-18" tabindex="-1"></a></span>
<span id="cb221-19"><a href="subgroups2.html#cb221-19" tabindex="-1"></a><span class="sc">$</span>N_CV</span>
<span id="cb221-20"><a href="subgroups2.html#cb221-20" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.4861189</span></span>
<span id="cb221-21"><a href="subgroups2.html#cb221-21" tabindex="-1"></a></span>
<span id="cb221-22"><a href="subgroups2.html#cb221-22" tabindex="-1"></a><span class="sc">$</span>N_L95</span>
<span id="cb221-23"><a href="subgroups2.html#cb221-23" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">1377</span></span>
<span id="cb221-24"><a href="subgroups2.html#cb221-24" tabindex="-1"></a></span>
<span id="cb221-25"><a href="subgroups2.html#cb221-25" tabindex="-1"></a><span class="sc">$</span>N_U95</span>
<span id="cb221-26"><a href="subgroups2.html#cb221-26" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">13456</span></span>
<span id="cb221-27"><a href="subgroups2.html#cb221-27" tabindex="-1"></a></span>
<span id="cb221-28"><a href="subgroups2.html#cb221-28" tabindex="-1"></a><span class="sc">$</span>ER</span>
<span id="cb221-29"><a href="subgroups2.html#cb221-29" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.001747709</span></span>
<span id="cb221-30"><a href="subgroups2.html#cb221-30" tabindex="-1"></a></span>
<span id="cb221-31"><a href="subgroups2.html#cb221-31" tabindex="-1"></a><span class="sc">$</span>ESW</span>
<span id="cb221-32"><a href="subgroups2.html#cb221-32" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">2.683627</span></span>
<span id="cb221-33"><a href="subgroups2.html#cb221-33" tabindex="-1"></a></span>
<span id="cb221-34"><a href="subgroups2.html#cb221-34" tabindex="-1"></a><span class="sc">$</span>ESW_CV</span>
<span id="cb221-35"><a href="subgroups2.html#cb221-35" tabindex="-1"></a>        <span class="dv">1</span> </span>
<span id="cb221-36"><a href="subgroups2.html#cb221-36" tabindex="-1"></a><span class="fl">0.1247504</span> </span>
<span id="cb221-37"><a href="subgroups2.html#cb221-37" tabindex="-1"></a></span>
<span id="cb221-38"><a href="subgroups2.html#cb221-38" tabindex="-1"></a><span class="sc">$</span>ss</span>
<span id="cb221-39"><a href="subgroups2.html#cb221-39" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">2.397167</span></span>
<span id="cb221-40"><a href="subgroups2.html#cb221-40" tabindex="-1"></a></span>
<span id="cb221-41"><a href="subgroups2.html#cb221-41" tabindex="-1"></a><span class="sc">$</span>n</span>
<span id="cb221-42"><a href="subgroups2.html#cb221-42" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">23</span></span>
<span id="cb221-43"><a href="subgroups2.html#cb221-43" tabindex="-1"></a></span>
<span id="cb221-44"><a href="subgroups2.html#cb221-44" tabindex="-1"></a><span class="sc">$</span>L</span>
<span id="cb221-45"><a href="subgroups2.html#cb221-45" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">13160.08</span></span>
<span id="cb221-46"><a href="subgroups2.html#cb221-46" tabindex="-1"></a></span>
<span id="cb221-47"><a href="subgroups2.html#cb221-47" tabindex="-1"></a><span class="sc">$</span>n_segments</span>
<span id="cb221-48"><a href="subgroups2.html#cb221-48" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">97</span></span>
<span id="cb221-49"><a href="subgroups2.html#cb221-49" tabindex="-1"></a></span>
<span id="cb221-50"><a href="subgroups2.html#cb221-50" tabindex="-1"></a><span class="sc">$</span>g0</span>
<span id="cb221-51"><a href="subgroups2.html#cb221-51" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.358</span></span>
<span id="cb221-52"><a href="subgroups2.html#cb221-52" tabindex="-1"></a></span>
<span id="cb221-53"><a href="subgroups2.html#cb221-53" tabindex="-1"></a><span class="sc">$</span>g0_cv</span>
<span id="cb221-54"><a href="subgroups2.html#cb221-54" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.325</span></span>
<span id="cb221-55"><a href="subgroups2.html#cb221-55" tabindex="-1"></a></span>
<span id="cb221-56"><a href="subgroups2.html#cb221-56" tabindex="-1"></a><span class="sc">$</span>iterations</span>
<span id="cb221-57"><a href="subgroups2.html#cb221-57" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">200</span></span>
<span id="cb221-58"><a href="subgroups2.html#cb221-58" tabindex="-1"></a></span>
<span id="cb221-59"><a href="subgroups2.html#cb221-59" tabindex="-1"></a><span class="sc">$</span>density_bootstraps</span>
<span id="cb221-60"><a href="subgroups2.html#cb221-60" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">10000</span></span></code></pre></div>
<p>The <code>g0_details</code> slot includes the results from the <code>g0_model()</code> and <code>g0_weighted()</code> functions called internally by <code>lta_subgroup()</code>. See those functions’ documentation pages for details.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="subgroups2.html#cb222-1" tabindex="-1"></a>results_subgroup<span class="sc">$</span>g0_details <span class="sc">%&gt;%</span> names</span>
<span id="cb222-2"><a href="subgroups2.html#cb222-2" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;summary&quot;</span></span></code></pre></div>
<p>The <code>df</code> slot includes details of the detection function fit. See the documentation for <code>df_plot()</code> for details.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="subgroups2.html#cb223-1" tabindex="-1"></a>results_subgroup<span class="sc">$</span>df <span class="sc">%&gt;%</span> names</span>
<span id="cb223-2"><a href="subgroups2.html#cb223-2" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;best_models&quot;</span>  <span class="st">&quot;all_models&quot;</span>   <span class="st">&quot;best_objects&quot;</span> <span class="st">&quot;sightings&quot;</span>   </span></code></pre></div>
<p>The <code>bootstraps</code> slot has the bootstrapped values for various parameters, in case they are useful for troubleshooting, subsequent analyses, and/or plotting:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="subgroups2.html#cb224-1" tabindex="-1"></a>results_subgroup<span class="sc">$</span>bootstraps <span class="sc">%&gt;%</span> names</span>
<span id="cb224-2"><a href="subgroups2.html#cb224-2" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;esw&quot;</span> <span class="st">&quot;ss&quot;</span>  <span class="st">&quot;g0&quot;</span>  <span class="st">&quot;er&quot;</span>  <span class="st">&quot;D&quot;</span>   <span class="st">&quot;N&quot;</span>  </span></code></pre></div>
<p>Some examples:</p>
<p><img src="figures/unnamed-chunk-295-1.png" width="672" /></p>
<p><img src="figures/unnamed-chunk-296-1.png" width="672" /></p>
<p><img src="figures/unnamed-chunk-297-1.png" width="672" /></p>
</div>
<div id="behind-the-scenes-2" class="section level2 unnumbered hasAnchor">
<h2>Behind the scenes<a href="subgroups2.html#behind-the-scenes-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This function performs the following operations:</p>
<ol style="list-style-type: decimal">
<li><p>Fits a detection function to <code>df_sits</code> without covariates, using the <code>LTabundR</code> function <code>df_fit()</code>, in order to estimate the effective strip width (ESW).</p></li>
<li><p>Conducts bootstrap re-sampling of the detection function fitting routine in order to estimate the CV of ESW.</p></li>
<li><p>Estimates the arithmetic mean subgroup size based on the <code>ss</code> input.</p></li>
<li><p>Creates a bootstrap-resampled distribution of subgroup sizes, with which CV is estimated.</p></li>
<li><p><em>Optional:</em> models the <em>Relative g(0)</em> in different survey conditions using the <code>LTabundR</code> function <code>g0_model()</code>. This function also estimates the CV of the <em>Rg(0)</em> estimate in each Beaufort sea state using jackknife resampling.</p></li>
<li><p>Estimates the encounter rate (subgroup detections / trackline surveyed).</p></li>
<li><p>Creates a bootstrap-resampled distribution of encounter rate estimates.</p></li>
<li><p>Calculates an empirical weighted <em>g(0)</em> estimate according to the proportion of effort occurring in each Beaufort sea state, then uses an automated parameter MCMC optimization routine (see details in <code>LTabundR</code> function <code>g0_weighted()</code>) to estimate the CV of the weighted <em>g(0)</em> estimate.</p></li>
<li><p>Creates a bootstrap-resampled distribution of the weighted <em>g(0)</em> estimate.</p></li>
<li><p>Estimates density using the point estimates of effective strip width, subgroup size, <em>g(0)</em>, and the encounter rate.</p></li>
<li><p>Estimates abundance by scaling the density estimate by the provided <code>abundance_area</code> input.</p></li>
<li><p>Creates a bootstrap-resampled distribution of the density estimate by iteratively drawing values from the resampled distributions of the constituent parameters of the density equation.</p></li>
<li><p>Creates a bootstrap-resampled distribution of the abundance estimate by scaling the density distribution by the <code>abundance_area</code> input.</p></li>
</ol>
<p>Note that this approach could theoretically be used for other species that occur in subgroups.</p>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="trend-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="diagnostic-plots.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/emk-noaa/emk-noaa.github.io11-subgroups.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["vignette.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
