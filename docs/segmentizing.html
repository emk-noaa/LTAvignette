<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 15 Segmentizing | vignette</title>
  <meta name="description" content=" 15 Segmentizing | vignette" />
  <meta name="generator" content="bookdown 0.24.3 and GitBook 2.6.7" />

  <meta property="og:title" content=" 15 Segmentizing | vignette" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content=" 15 Segmentizing | vignette" />
  <meta name="github-repo" content="emk-noaa/emk-noaa.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 15 Segmentizing | vignette" />
  
  <meta name="twitter:description" content=" 15 Segmentizing | vignette" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="stratagallery.html"/>
<link rel="next" href="abund9_compare.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.21/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">WinCruz analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Status</a></li>
<li class="part"><span><b>I Tutorial</b></span></li>
<li class="chapter" data-level="2" data-path="install.html"><a href="install.html"><i class="fa fa-check"></i><b>2</b> Install <code>LTabundR</code></a><ul>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#option-1-install-from-github"><i class="fa fa-check"></i>Option 1: Install from GitHub</a></li>
<li class="chapter" data-level="" data-path="install.html"><a href="install.html#option-2-install-locally"><i class="fa fa-check"></i>Option 2: Install locally</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="settings.html"><a href="settings.html"><i class="fa fa-check"></i><b>3</b> Settings</a><ul>
<li class="chapter" data-level="" data-path="settings.html"><a href="settings.html#survey-strata"><i class="fa fa-check"></i>Survey strata</a></li>
<li class="chapter" data-level="" data-path="settings.html"><a href="settings.html#study-area-polygon"><i class="fa fa-check"></i>Study area polygon</a></li>
<li class="chapter" data-level="" data-path="settings.html"><a href="settings.html#survey-wide-settings"><i class="fa fa-check"></i>Survey-wide settings</a></li>
<li class="chapter" data-level="" data-path="settings.html"><a href="settings.html#cohort-specific-settings"><i class="fa fa-check"></i>Cohort-specific settings</a></li>
<li class="chapter" data-level="" data-path="settings.html"><a href="settings.html#example-code"><i class="fa fa-check"></i>Example code</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="processing.html"><a href="processing.html"><i class="fa fa-check"></i><b>4</b> Data processing</a><ul>
<li class="chapter" data-level="" data-path="processing.html"><a href="processing.html#behind-the-scenes"><i class="fa fa-check"></i>Behind the scenes</a></li>
<li class="chapter" data-level="" data-path="processing.html"><a href="processing.html#review"><i class="fa fa-check"></i>Review</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>5</b> Maps</a><ul>
<li class="chapter" data-level="" data-path="maps.html"><a href="maps.html#publishable-maps"><i class="fa fa-check"></i>Publishable maps</a></li>
<li class="chapter" data-level="" data-path="maps.html"><a href="maps.html#interactive-maps"><i class="fa fa-check"></i>Interactive maps</a></li>
<li class="chapter" data-level="" data-path="maps.html"><a href="maps.html#interactive-dashboard"><i class="fa fa-check"></i>Interactive dashboard</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="summarize.html"><a href="summarize.html"><i class="fa fa-check"></i><b>6</b> Summarize survey</a><ul>
<li class="chapter" data-level="" data-path="summarize.html"><a href="summarize.html#summarize-effort"><i class="fa fa-check"></i>Summarize effort</a></li>
<li class="chapter" data-level="" data-path="summarize.html"><a href="summarize.html#summarize-by-beaufort"><i class="fa fa-check"></i>Summarize by Beaufort</a></li>
<li class="chapter" data-level="" data-path="summarize.html"><a href="summarize.html#summarize-sightings"><i class="fa fa-check"></i>Summarize sightings</a></li>
<li class="chapter" data-level="" data-path="summarize.html"><a href="summarize.html#summarize-certain-species"><i class="fa fa-check"></i>Summarize certain species</a></li>
<li><a href="summarize.html#cruz_explorer"><code>cruz_explorer()</code></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="lta.html"><a href="lta.html"><i class="fa fa-check"></i><b>7</b> Line-transect analysis</a></li>
<li class="chapter" data-level="8" data-path="multistock.html"><a href="multistock.html"><i class="fa fa-check"></i><b>8</b> Multi-stock LTA</a></li>
<li class="chapter" data-level="9" data-path="g0.html"><a href="g0.html"><i class="fa fa-check"></i><b>9</b> g(0)</a></li>
<li class="part"><span><b>II Case studies</b></span></li>
<li class="chapter" data-level="10" data-path="casestudies.html"><a href="casestudies.html"><i class="fa fa-check"></i><b>10</b> Central North Pacific</a></li>
<li class="chapter" data-level="11" data-path="california-current-system.html"><a href="california-current-system.html"><i class="fa fa-check"></i><b>11</b> California Current System</a></li>
<li class="chapter" data-level="12" data-path="eastern-tropical-pacific.html"><a href="eastern-tropical-pacific.html"><i class="fa fa-check"></i><b>12</b> Eastern Tropical Pacific</a></li>
<li class="chapter" data-level="13" data-path="practicalities.html"><a href="practicalities.html"><i class="fa fa-check"></i><b>13</b> Practicalities</a></li>
<li class="part"><span><b>III Appendix</b></span></li>
<li class="chapter" data-level="14" data-path="stratagallery.html"><a href="stratagallery.html"><i class="fa fa-check"></i><b>14</b> Strata gallery</a><ul>
<li class="chapter" data-level="" data-path="stratagallery.html"><a href="stratagallery.html#central-north-pacific"><i class="fa fa-check"></i>Central North Pacific</a></li>
<li class="chapter" data-level="" data-path="stratagallery.html"><a href="stratagallery.html#california-current"><i class="fa fa-check"></i>California Current</a></li>
<li class="chapter" data-level="" data-path="stratagallery.html"><a href="stratagallery.html#etp"><i class="fa fa-check"></i>ETP</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="segmentizing.html"><a href="segmentizing.html"><i class="fa fa-check"></i><b>15</b> Segmentizing</a><ul>
<li class="chapter" data-level="" data-path="segmentizing.html"><a href="segmentizing.html#approach"><i class="fa fa-check"></i>Approach</a></li>
<li class="chapter" data-level="" data-path="segmentizing.html"><a href="segmentizing.html#defaults-2"><i class="fa fa-check"></i>Defaults</a></li>
<li class="chapter" data-level="" data-path="segmentizing.html"><a href="segmentizing.html#day-vs-equal-length"><i class="fa fa-check"></i>Day vs Equal Length</a></li>
<li class="chapter" data-level="" data-path="segmentizing.html"><a href="segmentizing.html#contiguous-vs.-non-contiguous-effort"><i class="fa fa-check"></i>Contiguous vs. non-contiguous effort</a></li>
<li class="chapter" data-level="" data-path="segmentizing.html"><a href="segmentizing.html#segment-remainder-handling"><i class="fa fa-check"></i>Segment remainder handling</a></li>
<li class="chapter" data-level="" data-path="segmentizing.html"><a href="segmentizing.html#typical-settings"><i class="fa fa-check"></i>Typical settings</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="abund9_compare.html"><a href="abund9_compare.html"><i class="fa fa-check"></i><b>16</b> <code>LTabundR</code> vs. <code>ABUND9</code></a><ul>
<li class="chapter" data-level="" data-path="abund9_compare.html"><a href="abund9_compare.html#differences-in-total-effort"><i class="fa fa-check"></i>Differences in total effort</a></li>
<li class="chapter" data-level="" data-path="abund9_compare.html"><a href="abund9_compare.html#differences-in-on-effort-distance"><i class="fa fa-check"></i>Differences in on-effort distance</a></li>
<li class="chapter" data-level="" data-path="abund9_compare.html"><a href="abund9_compare.html#differences-it-total-sightings"><i class="fa fa-check"></i>Differences it total sightings</a></li>
<li class="chapter" data-level="" data-path="abund9_compare.html"><a href="abund9_compare.html#differences-in-on-effort-sightings"><i class="fa fa-check"></i>Differences in on-effort sightings</a></li>
<li class="chapter" data-level="" data-path="abund9_compare.html"><a href="abund9_compare.html#differences-in-school-size-estimation"><i class="fa fa-check"></i>Differences in school size estimation</a></li>
<li class="chapter" data-level="" data-path="abund9_compare.html"><a href="abund9_compare.html#processing-time"><i class="fa fa-check"></i>Processing time</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="misc_functions.html"><a href="misc_functions.html"><i class="fa fa-check"></i><b>17</b> Miscellaneous functions</a></li>
<li class="chapter" data-level="18" data-path="backlog.html"><a href="backlog.html"><i class="fa fa-check"></i><b>18</b> Appendix: Backlog</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/emk-noaa/emk-noaa.github.io" target="blank">Eric & Amanda</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">vignette</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="segmentizing" class="section level1">
<h1><span class="header-section-number"> 15</span> Segmentizing</h1>
<p>The package’s <code>segmentize()</code> function and its associated settings were designed to give researchers full control over how data are segmented, be it for design-based density analysis (which tend to use long segments of 100 km or more and allow for non-contiguous effort to be included in the same segment) or for habitat modeling (which tend to use short segments of 5 - 10 km and disallow non-contiguous effort to be pooled into the same segment).</p>
<div id="approach" class="section level2 unnumbered">
<h2>Approach</h2>
<ul>
<li><p>Segments are built and stored separately for each cohort of species, since each cohort has specific settings for segmentizing.</p></li>
<li><p>Within each cohort, the survey is first grouped into blocs of data that all share the same “effort scenario”, i.e., all rows share the same Cruise number, study area status (in or out), geographic stratum, and year. Since a survey may leave a stratum then return to it many days hence, it is normal for these blocs to contain non-contiguous data with large spatial gaps. These gaps will be addressed a few steps down.</p></li>
<li><p>The blocs are split a final time according to whether the effort scenario meets inclusion criteria for the analysis. These inclusion criteria are controlled by the cohort-specific settings such as <code>distance_types</code>, <code>distance_modes</code>, and <code>distance_on_off</code>. Rows of data that meet the inclusion criteria are relegated to their own data bloc, and given a new column, <code>use</code>, with the value <code>TRUE</code>. Data that do <em>not</em> meet the criteria are relegated to their own bloc as well (column <code>use</code> is <code>FALSE</code>). This means that, at the end of this process, we will have segments that <em>will</em> be used in the density/detection function analysis, and segments that will <em>not</em>. (The excluded segments are not deleted or transformed in any other way; they can still be used in summarizing detections, etc.)</p></li>
<li><p>Next, the <code>segmentize()</code> function loops through each of these blocs of effort and parses its data into segments according to the <code>segment_method</code>. If segmentizing by <code>"day"</code>, this is straightforward: all data occurring on a unique date are assigned to its own segment. Segmentizing by <code>"equallength"</code> is a bit more complicated in terms of coding: segments are built up one line of data at a time; if the <code>segment_target_km</code> is reached or the <code>segment_max_interval</code> is exceeded, a new segment begins.</p></li>
</ul>
<p>At the end of this process, you have lists of data sorted into their segments, each with a unique <code>seg_id</code>, as well as a summary dataframe that provides the distance (km); time and coordinates for the beginning, middle, and end of the segment; and the weighted averages of sighting conditions and weather data contained in the segment.</p>
<div id="setting-up-this-demo" class="section level3 unnumbered">
<h3>Setting up this demo</h3>
<p>The demonstration of <code>segmentize()</code> on in <a href="processing.html#processing">Processing chapter</a> relies on the <code>settings</code> list that is attached as a slot in the <code>cruz</code> object. But you can override those settings with direct function inputs in <code>segmentize()</code>, which gives us a chance to explore segmentization options.</p>
<p>First we load the demo data and carry out initial processing:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="segmentizing.html#cb78-1"></a><span class="kw">data</span>(settings)</span>
<span id="cb78-2"><a href="segmentizing.html#cb78-2"></a>das_file &lt;-<span class="st"> &#39;data/surveys/HICEASwinter2020.das&#39;</span></span>
<span id="cb78-3"><a href="segmentizing.html#cb78-3"></a>das &lt;-<span class="st"> </span><span class="kw">load_das</span>(das_file, </span>
<span id="cb78-4"><a href="segmentizing.html#cb78-4"></a>                <span class="dt">perform_checks =</span> <span class="ot">FALSE</span>,</span>
<span id="cb78-5"><a href="segmentizing.html#cb78-5"></a>                <span class="dt">print_glimpse =</span> <span class="ot">FALSE</span>)</span>
<span id="cb78-6"><a href="segmentizing.html#cb78-6"></a>cruz &lt;-<span class="st"> </span><span class="kw">process_strata</span>(das,</span>
<span id="cb78-7"><a href="segmentizing.html#cb78-7"></a>                       settings,</span>
<span id="cb78-8"><a href="segmentizing.html#cb78-8"></a>                       <span class="dt">verbose=</span><span class="ot">FALSE</span>)</span>
<span id="cb78-9"><a href="segmentizing.html#cb78-9"></a>cruz &lt;-<span class="st"> </span><span class="kw">format_das</span>(cruz)</span></code></pre></div>
<p>And this is the histogram function we will be using to display the results of each run of <code>segmentize()</code>:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="segmentizing.html#cb79-1"></a>segment_histogram &lt;-<span class="st"> </span><span class="cf">function</span>(cruz, <span class="dt">cohort=</span><span class="dv">1</span>, <span class="dt">by_day=</span><span class="ot">FALSE</span>){</span>
<span id="cb79-2"><a href="segmentizing.html#cb79-2"></a>  (settings &lt;-<span class="st"> </span>cruz<span class="op">$</span>settings)</span>
<span id="cb79-3"><a href="segmentizing.html#cb79-3"></a>  (segs &lt;-<span class="st"> </span>cruz<span class="op">$</span>cohorts[[cohort]]<span class="op">$</span>segments)</span>
<span id="cb79-4"><a href="segmentizing.html#cb79-4"></a>  (segmax &lt;-<span class="st"> </span><span class="kw">max</span>(segs<span class="op">$</span>dist,<span class="dt">na.rm=</span><span class="ot">TRUE</span>)<span class="op">*</span><span class="fl">1.1</span>)</span>
<span id="cb79-5"><a href="segmentizing.html#cb79-5"></a>  </span>
<span id="cb79-6"><a href="segmentizing.html#cb79-6"></a>  <span class="cf">if</span>(by_day){</span>
<span id="cb79-7"><a href="segmentizing.html#cb79-7"></a>    main_use &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;Segments (use) |  by day&#39;</span>)</span>
<span id="cb79-8"><a href="segmentizing.html#cb79-8"></a>    main_exclude &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;Segments (exclude) |  by day&#39;</span>)</span>
<span id="cb79-9"><a href="segmentizing.html#cb79-9"></a>  }<span class="cf">else</span>{</span>
<span id="cb79-10"><a href="segmentizing.html#cb79-10"></a>    (main_use &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;Segments (use) |  target: &#39;</span>,settings<span class="op">$</span>survey<span class="op">$</span>segment_target_km,<span class="st">&#39; km&#39;</span>))</span>
<span id="cb79-11"><a href="segmentizing.html#cb79-11"></a>    (main_exclude &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;Segments (exclude) |  target: &#39;</span>,settings<span class="op">$</span>survey<span class="op">$</span>segment_target_km,<span class="st">&#39; km&#39;</span>))</span>
<span id="cb79-12"><a href="segmentizing.html#cb79-12"></a>  }</span>
<span id="cb79-13"><a href="segmentizing.html#cb79-13"></a>  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb79-14"><a href="segmentizing.html#cb79-14"></a>  <span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">4.2</span>,<span class="fl">4.2</span>,<span class="fl">2.5</span>,.<span class="dv">5</span>))</span>
<span id="cb79-15"><a href="segmentizing.html#cb79-15"></a>  <span class="kw">hist</span>(segs<span class="op">$</span>dist[segs<span class="op">$</span>use],</span>
<span id="cb79-16"><a href="segmentizing.html#cb79-16"></a>       <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,segmax,<span class="dt">by=</span>segmax<span class="op">/</span><span class="dv">40</span>),</span>
<span id="cb79-17"><a href="segmentizing.html#cb79-17"></a>       <span class="dt">xlab=</span><span class="st">&#39;Segment lengths (km)&#39;</span>,</span>
<span id="cb79-18"><a href="segmentizing.html#cb79-18"></a>       <span class="dt">main=</span>main_use,</span>
<span id="cb79-19"><a href="segmentizing.html#cb79-19"></a>       <span class="dt">cex.main =</span> <span class="fl">.8</span>, <span class="dt">cex.axis =</span> <span class="fl">.8</span>, <span class="dt">cex.lab =</span> <span class="fl">.8</span>)</span>
<span id="cb79-20"><a href="segmentizing.html#cb79-20"></a></span>
<span id="cb79-21"><a href="segmentizing.html#cb79-21"></a>  <span class="kw">hist</span>(segs<span class="op">$</span>dist[<span class="op">!</span>segs<span class="op">$</span>use],</span>
<span id="cb79-22"><a href="segmentizing.html#cb79-22"></a>       <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,segmax,<span class="dt">by=</span>segmax<span class="op">/</span><span class="dv">40</span>),</span>
<span id="cb79-23"><a href="segmentizing.html#cb79-23"></a>       <span class="dt">xlab=</span><span class="st">&#39;Segment lengths (km)&#39;</span>,</span>
<span id="cb79-24"><a href="segmentizing.html#cb79-24"></a>       <span class="dt">main=</span>main_exclude,</span>
<span id="cb79-25"><a href="segmentizing.html#cb79-25"></a>       <span class="dt">cex.main =</span> <span class="fl">.8</span>, <span class="dt">cex.axis =</span> <span class="fl">.8</span>, <span class="dt">cex.lab =</span> <span class="fl">.8</span>)</span>
<span id="cb79-26"><a href="segmentizing.html#cb79-26"></a>  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb79-27"><a href="segmentizing.html#cb79-27"></a>}</span></code></pre></div>
</div>
</div>
<div id="defaults-2" class="section level2 unnumbered">
<h2>Defaults</h2>
<p>Here is the <code>segmentize()</code> function parameterized with the “factory default” settings from <code>load_settings()</code>.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="segmentizing.html#cb80-1"></a>cruz_demo &lt;-<span class="st"> </span><span class="kw">segmentize</span>(cruz,</span>
<span id="cb80-2"><a href="segmentizing.html#cb80-2"></a>                        <span class="dt">segment_method =</span> <span class="st">&#39;equallength&#39;</span>,</span>
<span id="cb80-3"><a href="segmentizing.html#cb80-3"></a>                        <span class="dt">segment_target_km =</span> <span class="dv">30</span>,</span>
<span id="cb80-4"><a href="segmentizing.html#cb80-4"></a>                        <span class="dt">segment_max_interval =</span> <span class="dv">48</span>,</span>
<span id="cb80-5"><a href="segmentizing.html#cb80-5"></a>                        <span class="dt">segment_remainder_handling =</span> <span class="kw">c</span>(<span class="st">&#39;append&#39;</span>,<span class="st">&#39;segment&#39;</span>),</span>
<span id="cb80-6"><a href="segmentizing.html#cb80-6"></a>                        <span class="dt">distance_types =</span> <span class="kw">c</span>(<span class="st">&#39;S&#39;</span>,<span class="st">&#39;F&#39;</span>,<span class="st">&#39;N&#39;</span>),</span>
<span id="cb80-7"><a href="segmentizing.html#cb80-7"></a>                        <span class="dt">distance_modes =</span> <span class="kw">c</span>(<span class="st">&#39;P&#39;</span>,<span class="st">&#39;C&#39;</span>),</span>
<span id="cb80-8"><a href="segmentizing.html#cb80-8"></a>                        <span class="dt">distance_on_off =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>),</span>
<span id="cb80-9"><a href="segmentizing.html#cb80-9"></a>                        <span class="dt">verbose=</span><span class="ot">FALSE</span>)</span>
<span id="cb80-10"><a href="segmentizing.html#cb80-10"></a></span>
<span id="cb80-11"><a href="segmentizing.html#cb80-11"></a><span class="co"># Number of segments</span></span>
<span id="cb80-12"><a href="segmentizing.html#cb80-12"></a>cruz_demo<span class="op">$</span>cohorts<span class="op">$</span>default<span class="op">$</span>segments <span class="op">%&gt;%</span><span class="st"> </span>nrow</span>
<span id="cb80-13"><a href="segmentizing.html#cb80-13"></a>[<span class="dv">1</span>] <span class="dv">273</span></span>
<span id="cb80-14"><a href="segmentizing.html#cb80-14"></a></span>
<span id="cb80-15"><a href="segmentizing.html#cb80-15"></a><span class="co"># Plot</span></span>
<span id="cb80-16"><a href="segmentizing.html#cb80-16"></a><span class="kw">segment_histogram</span>(cruz_demo)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-103-1.png" width="672" /></p>
</div>
<div id="day-vs-equal-length" class="section level2 unnumbered">
<h2>Day vs Equal Length</h2>
<div id="by-day" class="section level3 unnumbered">
<h3>By day</h3>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="segmentizing.html#cb81-1"></a>cruz_demo &lt;-<span class="st"> </span><span class="kw">segmentize</span>(cruz,</span>
<span id="cb81-2"><a href="segmentizing.html#cb81-2"></a>                        <span class="dt">segment_method =</span> <span class="st">&#39;day&#39;</span>,</span>
<span id="cb81-3"><a href="segmentizing.html#cb81-3"></a>                        <span class="dt">segment_target_km =</span> <span class="dv">30</span>,</span>
<span id="cb81-4"><a href="segmentizing.html#cb81-4"></a>                        <span class="dt">segment_max_interval =</span> <span class="dv">48</span>,</span>
<span id="cb81-5"><a href="segmentizing.html#cb81-5"></a>                        <span class="dt">verbose=</span><span class="ot">FALSE</span>)</span>
<span id="cb81-6"><a href="segmentizing.html#cb81-6"></a></span>
<span id="cb81-7"><a href="segmentizing.html#cb81-7"></a><span class="co"># Number of segments</span></span>
<span id="cb81-8"><a href="segmentizing.html#cb81-8"></a>cruz_demo<span class="op">$</span>cohorts<span class="op">$</span>default<span class="op">$</span>segments <span class="op">%&gt;%</span><span class="st"> </span>nrow</span>
<span id="cb81-9"><a href="segmentizing.html#cb81-9"></a>[<span class="dv">1</span>] <span class="dv">113</span></span>
<span id="cb81-10"><a href="segmentizing.html#cb81-10"></a></span>
<span id="cb81-11"><a href="segmentizing.html#cb81-11"></a><span class="co"># Plot</span></span>
<span id="cb81-12"><a href="segmentizing.html#cb81-12"></a><span class="kw">segment_histogram</span>(cruz_demo, <span class="dt">by_day =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-104-1.png" width="672" /></p>
</div>
<div id="by-target-length-of-150-km" class="section level3 unnumbered">
<h3>By target length of 150 km</h3>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="segmentizing.html#cb82-1"></a>cruz_demo &lt;-<span class="st"> </span><span class="kw">segmentize</span>(cruz,</span>
<span id="cb82-2"><a href="segmentizing.html#cb82-2"></a>                        <span class="dt">segment_method =</span> <span class="st">&#39;equallength&#39;</span>,</span>
<span id="cb82-3"><a href="segmentizing.html#cb82-3"></a>                        <span class="dt">segment_target_km =</span> <span class="dv">150</span>,</span>
<span id="cb82-4"><a href="segmentizing.html#cb82-4"></a>                        <span class="dt">segment_max_interval =</span> <span class="dv">48</span>,</span>
<span id="cb82-5"><a href="segmentizing.html#cb82-5"></a>                        <span class="dt">verbose=</span><span class="ot">FALSE</span>)</span>
<span id="cb82-6"><a href="segmentizing.html#cb82-6"></a></span>
<span id="cb82-7"><a href="segmentizing.html#cb82-7"></a><span class="co"># Number of segments</span></span>
<span id="cb82-8"><a href="segmentizing.html#cb82-8"></a>cruz_demo<span class="op">$</span>cohorts<span class="op">$</span>default<span class="op">$</span>segments <span class="op">%&gt;%</span><span class="st"> </span>nrow</span>
<span id="cb82-9"><a href="segmentizing.html#cb82-9"></a>[<span class="dv">1</span>] <span class="dv">66</span></span>
<span id="cb82-10"><a href="segmentizing.html#cb82-10"></a></span>
<span id="cb82-11"><a href="segmentizing.html#cb82-11"></a><span class="co"># Plot</span></span>
<span id="cb82-12"><a href="segmentizing.html#cb82-12"></a><span class="kw">segment_histogram</span>(cruz_demo, <span class="dt">by_day =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-105-1.png" width="672" /></p>
</div>
</div>
<div id="contiguous-vs.-non-contiguous-effort" class="section level2 unnumbered">
<h2>Contiguous vs. non-contiguous effort</h2>
<p>The example above allows for non-contiguous effort; a segment is allowed to contain effort separated by gaps as large as 24 hours (<code>settings$max_interval</code>). To coerce segments to represent only contiguous effort, make that setting very small:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="segmentizing.html#cb83-1"></a>cruz_demo &lt;-<span class="st"> </span><span class="kw">segmentize</span>(cruz,</span>
<span id="cb83-2"><a href="segmentizing.html#cb83-2"></a>                        <span class="dt">segment_method =</span> <span class="st">&#39;equallength&#39;</span>,</span>
<span id="cb83-3"><a href="segmentizing.html#cb83-3"></a>                        <span class="dt">segment_target_km =</span> <span class="dv">30</span>,</span>
<span id="cb83-4"><a href="segmentizing.html#cb83-4"></a>                        <span class="dt">segment_max_interval =</span> <span class="fl">.1</span>,</span>
<span id="cb83-5"><a href="segmentizing.html#cb83-5"></a>                        <span class="dt">verbose=</span><span class="ot">FALSE</span>)</span>
<span id="cb83-6"><a href="segmentizing.html#cb83-6"></a></span>
<span id="cb83-7"><a href="segmentizing.html#cb83-7"></a><span class="co"># Number of segments</span></span>
<span id="cb83-8"><a href="segmentizing.html#cb83-8"></a>cruz_demo<span class="op">$</span>cohorts<span class="op">$</span>default<span class="op">$</span>segments <span class="op">%&gt;%</span><span class="st"> </span>nrow</span>
<span id="cb83-9"><a href="segmentizing.html#cb83-9"></a>[<span class="dv">1</span>] <span class="dv">567</span></span>
<span id="cb83-10"><a href="segmentizing.html#cb83-10"></a></span>
<span id="cb83-11"><a href="segmentizing.html#cb83-11"></a><span class="co"># Plot</span></span>
<span id="cb83-12"><a href="segmentizing.html#cb83-12"></a><span class="kw">segment_histogram</span>(cruz_demo, <span class="dt">by_day =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-106-1.png" width="672" /></p>
<p>You can see that many contiguous periods of effort were much shorter than the target length of 30 km. This is why allowing for non-contiguous effort can be advantageous for target segment lengths larger than 5 - 10 km.</p>
</div>
<div id="segment-remainder-handling" class="section level2 unnumbered">
<h2>Segment remainder handling</h2>
<p>The default setting for <code>segment_remainder_handling</code>, <code>c('append','segment')</code>, means that remainders less than half the target length will be randomly appended to another segment, while remainders more than half will be treated as their own segment (and will be placed randomly along the trackline).</p>
<p>If you don’t want that level of complexity, you can simply assign a single setting: <code>'append'</code> will append the remainder in all cases, regardless of remainder length relative to the target length. The same idea goes for <code>'segment'</code>.</p>
<p>The other possible setting is <code>'disperse'</code>, which disperses the remainder evenly across all segments. To demonstrate, let’s use a target length of 100 km.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="segmentizing.html#cb84-1"></a>cruz_demo &lt;-<span class="st"> </span><span class="kw">segmentize</span>(cruz,</span>
<span id="cb84-2"><a href="segmentizing.html#cb84-2"></a>                        <span class="dt">segment_method =</span> <span class="st">&#39;equallength&#39;</span>,</span>
<span id="cb84-3"><a href="segmentizing.html#cb84-3"></a>                        <span class="dt">segment_target_km =</span> <span class="dv">100</span>,</span>
<span id="cb84-4"><a href="segmentizing.html#cb84-4"></a>                        <span class="dt">segment_max_interval =</span> <span class="dv">48</span>,</span>
<span id="cb84-5"><a href="segmentizing.html#cb84-5"></a>                        <span class="dt">verbose=</span><span class="ot">FALSE</span>)</span>
<span id="cb84-6"><a href="segmentizing.html#cb84-6"></a></span>
<span id="cb84-7"><a href="segmentizing.html#cb84-7"></a><span class="co"># Number of segments</span></span>
<span id="cb84-8"><a href="segmentizing.html#cb84-8"></a>cruz_demo<span class="op">$</span>cohorts<span class="op">$</span>default<span class="op">$</span>segments <span class="op">%&gt;%</span><span class="st"> </span>nrow</span>
<span id="cb84-9"><a href="segmentizing.html#cb84-9"></a>[<span class="dv">1</span>] <span class="dv">90</span></span>
<span id="cb84-10"><a href="segmentizing.html#cb84-10"></a></span>
<span id="cb84-11"><a href="segmentizing.html#cb84-11"></a><span class="co"># Plot</span></span>
<span id="cb84-12"><a href="segmentizing.html#cb84-12"></a><span class="kw">segment_histogram</span>(cruz_demo, <span class="dt">by_day =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-107-1.png" width="672" /></p>
<p>Note that most segments are longer than the target length, due to the impact of dispersing the remainder. If you wanted, you could combat this by making the target length slightly smaller:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="segmentizing.html#cb85-1"></a>cruz_demo &lt;-<span class="st"> </span><span class="kw">segmentize</span>(cruz,</span>
<span id="cb85-2"><a href="segmentizing.html#cb85-2"></a>                        <span class="dt">segment_method =</span> <span class="st">&#39;equallength&#39;</span>,</span>
<span id="cb85-3"><a href="segmentizing.html#cb85-3"></a>                        <span class="dt">segment_target_km =</span> <span class="dv">90</span>,</span>
<span id="cb85-4"><a href="segmentizing.html#cb85-4"></a>                        <span class="dt">segment_max_interval =</span> <span class="dv">48</span>,</span>
<span id="cb85-5"><a href="segmentizing.html#cb85-5"></a>                        <span class="dt">verbose=</span><span class="ot">FALSE</span>)</span>
<span id="cb85-6"><a href="segmentizing.html#cb85-6"></a></span>
<span id="cb85-7"><a href="segmentizing.html#cb85-7"></a><span class="co"># Number of segments</span></span>
<span id="cb85-8"><a href="segmentizing.html#cb85-8"></a>cruz_demo<span class="op">$</span>cohorts<span class="op">$</span>default<span class="op">$</span>segments <span class="op">%&gt;%</span><span class="st"> </span>nrow</span>
<span id="cb85-9"><a href="segmentizing.html#cb85-9"></a>[<span class="dv">1</span>] <span class="dv">98</span></span>
<span id="cb85-10"><a href="segmentizing.html#cb85-10"></a></span>
<span id="cb85-11"><a href="segmentizing.html#cb85-11"></a><span class="co"># Plot</span></span>
<span id="cb85-12"><a href="segmentizing.html#cb85-12"></a><span class="kw">segment_histogram</span>(cruz_demo, <span class="dt">by_day =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-108-1.png" width="672" /></p>
<p>But in general, the <code>disperse</code> option may be more appropriate for shorter segment lengths.</p>
</div>
<div id="typical-settings" class="section level2 unnumbered">
<h2>Typical settings</h2>
<div id="design-based-line-transect-analysis" class="section level3 unnumbered">
<h3>Design-based line transect analysis</h3>
<p>To replicate methods used in density estimation analyses, use large segment lengths (100 km or more) or simply segmentize by day. (See the examples above.) Remember that long segment lengths won’t work well unless you allow for non-contiguous effort.</p>
</div>
<div id="habitat-modeling" class="section level3 unnumbered">
<h3>Habitat modeling</h3>
<p>To replicate the methods used in typical habitat modeling studies, use smaller segment lengths of contiguous effort.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="segmentizing.html#cb86-1"></a>cruz_demo &lt;-<span class="st"> </span><span class="kw">segmentize</span>(cruz,</span>
<span id="cb86-2"><a href="segmentizing.html#cb86-2"></a>                        <span class="dt">segment_method =</span> <span class="st">&#39;equallength&#39;</span>,</span>
<span id="cb86-3"><a href="segmentizing.html#cb86-3"></a>                        <span class="dt">segment_target_km =</span> <span class="dv">5</span>,</span>
<span id="cb86-4"><a href="segmentizing.html#cb86-4"></a>                        <span class="dt">segment_max_interval =</span> <span class="fl">.1</span>,</span>
<span id="cb86-5"><a href="segmentizing.html#cb86-5"></a>                        <span class="dt">verbose=</span><span class="ot">FALSE</span>)</span>
<span id="cb86-6"><a href="segmentizing.html#cb86-6"></a></span>
<span id="cb86-7"><a href="segmentizing.html#cb86-7"></a><span class="co"># Number of segments</span></span>
<span id="cb86-8"><a href="segmentizing.html#cb86-8"></a>cruz_demo<span class="op">$</span>cohorts<span class="op">$</span>default<span class="op">$</span>segments <span class="op">%&gt;%</span><span class="st"> </span>nrow</span>
<span id="cb86-9"><a href="segmentizing.html#cb86-9"></a>[<span class="dv">1</span>] <span class="dv">1728</span></span>
<span id="cb86-10"><a href="segmentizing.html#cb86-10"></a></span>
<span id="cb86-11"><a href="segmentizing.html#cb86-11"></a><span class="co"># Plot</span></span>
<span id="cb86-12"><a href="segmentizing.html#cb86-12"></a><span class="kw">segment_histogram</span>(cruz_demo, <span class="dt">by_day =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="figures/unnamed-chunk-109-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="stratagallery.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="abund9_compare.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/emk-noaa/emk-noaa.github.io91-appendix_segmentizing.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["vignette.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
