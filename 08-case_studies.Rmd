#  Case studies {#casestudies}


To demonstrate what we are building, below is template for quickly running all of the steps detailed in subsequent chapters. 


## Central North Pacific  {-} 

This template use the same data and settings used throughout the vignette: 

```{r, echo=TRUE, eval=FALSE, collapse=TRUE, message=FALSE, warning=FALSE}
library(LTabundR)

# Settings =====================================================================

# Load strata & study area
data(strata_cnp)
data(study_cnp)

# Survey-wide
survey <- 
  load_survey_settings(segment_method = 'equallength',
                       segment_target_km = 30,
                       segment_max_km_gap = 5,
                       segment_max_interval = 48,
                       segment_type_handling = 'separate',
                       segment_remainder_handling = c('append','segment'),
                       verbose = TRUE)

# Cohort 1 (default)
cohort1 <- load_cohort_settings()

# Cohort 2
cohort2 <- 
  load_cohort_settings(id='fkw_insular',
                       species=33,
                       use_low_if_na = TRUE,
                       truncation_km = 5,
                       strata_overlap_handling = 'each')

# Finalize settings
settings <- load_settings(strata = strata_cnp,
                          study_area = study_cnp,
                          survey = survey,
                          cohorts=list(cohort1,
                                       cohort2))


# Processing ===================================================================

# Load & format DAS
das_file <- 'data/surveys/HICEASwinter2020.das'
das <- load_das(das_file, 
                perform_checks = TRUE,
                print_glimpse = TRUE)
das <- format_das(das, settings)

# Process strata
cruz <- process_strata(das, settings)

# Sanity-check stratum assignments
cruz$cohorts$default$stratum %>% table(useNA='ifany')
cruz$cohorts$fkw_insular$stratum %>% table(useNA='ifany')

# Segmentize
cruz <- segmentize(cruz, verbose=TRUE)

# Review: Number of segments
cruz$cohorts$default$density$segments %>% nrow

# Review: segment length distribution
hist(cruz$cohorts$default$density$segments$dist,
     breaks = seq(0,60,by=1),
     xlab='Segment lengths (km)',
     main=paste0('Target km: ',settings$survey$segment_target_km))


```

## California Current System  {-} 

```{r, echo=TRUE, eval=FALSE, collapse=TRUE, message=FALSE, warning=FALSE}
library(LTabundR)

# Read in DAS data
das_file <- 'data/surveys/CAORWA_91-09.das'
das <- load_das(das_file)

# Subset to a single cruise
das <- das %>% filter(Cruise == 1635)


```


## Eastern Tropical Pacific  {-}  




